/*pub-1|2013-04-24 14:11:20*/(function(b){var a="tgallery/department/common/brandbar";(!b.config)&&b.add(a,{requires:["core"]});b.add(a,function(f,g,c){var d,h={};g=g||f.DOM;c=c||f.Event;var e={show:function(j){f.mix(h,j);j=j||{};if(!d){g.addStyleSheet('#J_BrandBar{font-size:12px;cursor:pointer;background-color:#EEEEEE;width:120px;margin:2px 5px 0 5px;height:28px;border:solid 1px #d0d0d0;-moz-border-radius: 3px 3px 0px 0px;-khtml-border-radius: 3px 3px 0px 0px;-webkit-border-radius: 3px 3px 0px 0px;border-radius: 3px 3px 0px 0px;}#J_BrandBar:hover,#J_BrandBar.hoverBrandBar{background-color:#d9d1d1;border-color:#bcb0b0}.BrandFlyer{width:20px;height:20px;float:left;margin:4px;background:url(http://img02.taobaocdn.com/tps/i2/T1_360XiFkXXcu5FDa-20-20.png);background-repeat:no-repeat;*background:none;*filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=noscale, src="http://img02.taobaocdn.com/tps/i2/T1_360XiFkXXcu5FDa-20-20.png");}#J_BrandBar a,#J_BrandBar a:hover{line-height:20px;display:block;margin:4px;float:left;color:#181818;text-decoration:none;}');d=g.create('<div id="J_BrandBar" order="20">');var i=j.urlMyBrand||"http://brand.tmall.com/myBrandsIndex.htm";g.html(d,'<div class="BrandFlyer"></div><a href="'+i+'" target="'+(j.newWindow?' target="_blank"':"")+'">\u6211\u5173\u6ce8\u7684\u54c1\u724c</a>');c.on(d,"click",function(){new Image().src="http://log.mmstat.com/tmallbrand.1001.1.2.3";g.get("a",d).click()});if(f.UA.ie==6){c.on(d,"mouseenter",function(){g.addClass(d,"hoverBrandBar")});c.on(d,"mouseleave",function(){g.removeClass(d,"hoverBrandBar")})}}f.onTgalleryReady("tgallery/tmall/common/bottombar",function(k,l){l.add(d)})},bindEl:function(l,j){var i=this;f.mix(h,j);j=j||{};var k=c.delegate||function(m,n,q,p,o){c.on(m,n,function(r){var s=false;f.each(g.query(q,m),function(t){if(!s&&(t==r.target||g.contains(t,r.target))){s=true}});if(!s){return}p&&p.apply(this,arguments)},o)};k(document,"click",l,function(n){n.halt();if(n.brandCooked){return}n.brandCooked=true;var o=n.target,m=j.attrName||"data-brandid";while(o&&!(brandId=g.attr(o,m))){o=g.parent(o)}if(!o){return}i.flyAdd(o,brandId,j)})},flyAdd:function(l,m,j){f.mix(h,j);j=j||{};var o=g.offset(l),i=this,k=f.mix({},j);o={left:o.left+g.width(l)/2,top:o.top+g.height(l)/2};var n=g.attr(l,"offset-brandfly");if(n&&(/[\d-]+,[\d-]+/.test(n))){n=n.split(",");k.offset=k.offset||{left:0,top:0};k.offset.left+=parseInt(n[0]);k.offset.top+=parseInt(n[1])}if(k.offset){o.left+=k.offset.left;o.top+=k.offset.top}k.success=function(q){if(k.flyed){return}k.flyed=true;q=q||{};q.flyNode=l;var p=j.success&&j.success(q);if(i.fire("success",q)===false||p===false){return}f.onTgalleryReady("tgallery/department/common/brandbar-fly",function(s,r){s.mix(i,r);i.fly(o,g.get(".BrandFlyer",d),{complete:function(){var t=j.flyComplete&&j.flyComplete();if(i.fire("flyComplete",q)===false||t===false){return}}})})};k.error=function(q){var p=j.error&&j.error(q);q.flyNode=l;if(i.fire("error",q)===false||p===false){return}function r(t){if(window.TML){t(f,window.TML);return}f.getScript(f.configTgallery.path+"tmall/tml/1.0/tml/tml-min.js",function(){t(f,window.TML)})}function s(u,v,t){r(function(y,x){if(y.config){x.use(u,v||function(){});return}if(t&&t(x)){v&&v(y,t(x));return}var w=y.configTgallery.path+"tmall/tml/1.0/tml/"+u;if(u.indexOf(".")<0){w+=".js"}y.getScript(w,function(){v&&v(y,t&&t(x))})})}s("overlay",function(u,t){s("overlay/css/overlay.css");f.getScript(f.configTgallery.path+"tmall/mui/msg/css/msg.css");g.addStyleSheet(".brandMsgTips{margin-top:-10px;}.brandTipsDialog div.tml-stdmod-header{height:24px;background:none;border:none;}.brandTipsDialog .tml-stdmod-body{padding:0 10px;}.brandMsgTips-btn{margin-top:30px;text-align:center;}.brandMsgTips-btn a{padding:0 15px;margin:0 30px;}.brandMsgTips-p{font-size:12px;font-weight:normal;margin-top:10px;}.brandMsgTips-p a{color:#2b76af;}");var w=q.code==-1?"attention":"error",y=h.urlMyBrand||"http://brand.tmall.com/myBrandsIndex.htm",x='<div class="brandMsgTips"><div class="ui-msg ui-top-tip ui-msg-clean"><div class="ui-msg-con ui-msg-'+w+'">'+q.message+'<p class="brandMsgTips-p">\u67e5\u770b<a href="'+y+'">\u6211\u5173\u6ce8\u7684\u54c1\u724c>></a></p><s class="ui-msg-icon"></s></div></div></div>';var v=new t.Dialog({elCls:"brandTipsDialog",width:300,height:110,skin:"gray",closeAction:"destroy",elStyle:{position:f.UA.ie==6?"absolute":"fixed"},zIndex:9999999,headerContent:"",bodyContent:x,showCat:false,mask:true,align:{points:["cc","cc"]}});v.render();v.show()},function(t){return t.Overlay})};f.onTgalleryReady("tgallery/department/common/brandfollow",function(q,p){p.add(m,k)})}};f.mix(e,f.EventTarget);return f[a]=f[a]||e},{requires:["dom","event"]})})(KISSY);