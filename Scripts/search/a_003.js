/*pub-1|2013-01-22 10:50:12*/ALD_INIT_JS_URL="http://"+ASSETS_SERVER+"/apps/tmall/ald/init.js?t="+ALD_T;KISSY.add(V+"/mods/ald",function(S){var D=S.DOM,E=S.Event,win=window,criticalView=1,aldElCls="j_Ald",styleCls="aldItem",aldCon=S.get("#J_AldRight"),container=D.prev(aldCon,".container"),loadingCls="aldRight-loading",aldCfgAttr="data-ald-cfg",aldInitAttr="data-ald-init";function Ald(){if(!(this instanceof Ald)){return new Ald()}this.hasBindEvent=false;this.isInit=false;this.aldNum=0;this.usableNum=0;this._init()}S.augment(Ald,S.EventTarget,{_init:function(){var self=this,curView=win.g_config.view;if(!self.hasBindEvent){self._bindEvent()}if(curView<criticalView){return }!!aldCon&&D.show(aldCon);self._requestAld()},_bindEvent:function(){var self=this;LIST.msg.on("viewchange",function(e){if(e.view<criticalView){D.hide(aldCon)}else{D.show(aldCon);!self.isInit&&self._init()}})},_getConfig:function(el){var attr=D.attr(el,aldCfgAttr)||"",cfg=eval("("+attr+")");cfg=S.merge(cfg,{render:el.id?"#"+el.id:el});S.log(cfg);return cfg},_requestAld:function(){var self=this,renderCount=0,timeCount=0,renderAld=function(){S.each(S.query("."+aldElCls),function(item){var cfg=self._getConfig(item);ALD.load(cfg);self.aldNum++});ALD.on("afterRender",function(ev){S.log("ald after render....");var el=S.get(ev.config.render);renderCount++;!!container&&D.height(container)<D.height(aldCon)?D.hide(el):D.addClass(el,styleCls);ev.render.hasUsableData()?self.usableNum++:D.hide(el);if(renderCount==self.aldNum&&self.usableNum==0){self.fire("noresult")}self.removeLoading()});ALD.on("timeoutException",function(){S.log("ald timeout exception...");timeCount++;if(timeCount==self.aldNum){self.fire("noresult")}})};self.isInit=true;window.ALD?renderAld():S.getScript(ALD_INIT_JS_URL,renderAld);S.log("ald recommend init ...")},removeLoading:function(){if(aldCon){D.removeClass(aldCon,loadingCls)}}});return{init:function(){var ald=new Ald(),p4pTpl='<p class="recRight-hd">\u5546\u5bb6\u70ed\u5356</p>{{#each data as vo loc}}<div class="recRight-item">   <a href="{{vo.EURL}}" atpanel="{atpanel}" target="_blank" class="rR-item-img"><img src="{{vo.TBGOODSLINK}}" /></a>    <a href="{{vo.EURL}}" atpanel="{atpanel}" target="_blank" class="rR-item-title">{{vo.TITLE}}</a>    <p class="ui-price">&yen;{{vo.GOODSPRICE}}</p></div>{{/each}}';ald.on("noresult",function(){S.log("ald no result ...");D.hide("."+aldElCls);ald.removeLoading();KISSY.use(V+"/mods/p4p",function(S,P4P){new P4P({conId:"#J_RightRecommend",tpl:p4pTpl,imgFix:"_80x80.jpg",params:{count:5}}).init()});ald.detach("noresult")})}}});/*pub-1|2013-04-16 10:34:41*/KISSY.add(V+"/mods/crumb",function(j,g,w){var s=j.DOM,q=j.Event,G=document,i=window,x=j.UA.ie==6,r=s.get("#J_CrumbSlide"),o=s.get("#J_CrumbSlideCon"),l=s.get("#J_CrumbSlidePrev"),z=s.get("#J_CrumbSlideNext"),f=function(){return s.innerWidth(r)},v=f(),b=s.get("#J_CrumbSearchInuput"),h=s.get("#J_CrumbSearchBtn"),k=s.get("#J_CrumbSearchForm"),u="crumbDrop-hover",e=s.get("#J_MallNavMore"),d=s.get("#J_MallNavHover"),p="mm-menu-hover",t=["\u5728\u672c\u5e97\u641c\u7d22","\u5728\u5f53\u524d\u6761\u4ef6\u4e0b\u641c\u7d22"],B=".crumbSearch",F=".crumbAttr",y=".crumbArrow",n=s.get(B),C=s.parent(B),a=s.get(F),m=true;function c(){if(!(this instanceof c)){return new c()}this.searchType=s.attr(b,"data-type")||null;this.liWidth=0;this.offsetLeft=0;this.aWidth=5;this.anim=null;this._init()}j.augment(c,j.EventTarget,{_init:function(){var A=this;if(!o){return}if(b.value==""){b.value=this.searchType=="s"?t[0]:t[1]}j.each(s.query("li",o),function(D){A.liWidth+=s.outerWidth(D,true)});j.log(A.liWidth);A._bindEvent();A._setBtnType();A._resetListPos(true)},_bindEvent:function(){var D=this;q.on(h,"click",function(H){var H=H||i.event;H.stopPropagation||(H.cancelBubble=true)});if(e){q.on(e,"mouseenter",function(){s.addClass(this,p);s.show(d)});q.on(e,"mouseleave",function(){s.removeClass(this,p);s.hide(d)})}var A=this.searchType=="s"?t[0]:t[1],E=s.val(b);q.on(b,"focus",function(){s.addClass([this,this.parentNode],"focus");if(s.val(this)==A){s.val(this,"")}else{this.select()}});q.on(b,"blur",function(){s.removeClass([this,this.parentNode],"focus");if(s.val(this)==""){s.val(this,A)}});q.on(k,"submit",function(H){var I=j.trim(s.val(b));if(I==A){s.val(b,"")}else{if(I==E){H.halt()}}});q.on(G.body,"click",function(I){var J=s.val(b),H=I.target;if(J&&J!=E&&H.id!=h.id&&H.id!=b.id){s.val(b,E)}});q.on([l,z],"click",function(H){H.halt();D._resetListPos(false,true)});LIST.msg.fire("ie6Hover",{classname:["crumbAttr","mallNav-more","crumbSearch-btn"]});LIST.msg.fire("ie6Hover",{id:"mallCate",hoverCls:"hover"});LIST.msg.on("viewchange",function(H){v=f();D._resetListPos()});D._dropdown()},_setBtnType:function(){var A=this;l.style.visibility=z.style.visibility="hidden";if(A.liWidth<=v){!m&&A._crumbAnim();m=true;return}var D=parseInt(s.css(o,"left"));(D!==0)&&(l.style.visibility="visible");(D===0)&&(z.style.visibility="visible")},_resetListPos:function(K,M,I){var L=this,D=L.anim,A=parseInt(s.css(o,"left")),E=L.liWidth-v,H=Math.min(-E,0),H=M?(A==0?-E:0):H,H=H+(I||0),J=(A==H)?true:false;if(J){L._setBtnType.call(L);return}if(K){s.css(o,{left:H+"px"});L._setBtnType.call(L);return}time=(time=Math.abs(H/400))==0?0.1:time;if(D){D.stop()}L.anim=j.Anim(o,{left:H+"px"},time,"easeOutStrong",function(){L._setBtnType.call(L)});L.anim.run()},_dropdown:function(){var D=this,E='{{#each data as val idx}}{{#if idx%6 == 0}}<ul>{{/if}}<li><a {{#if idx == 0}}class="crumbDrop-disable"{{/if}} atpanel="{{val.atp}}" href="{{val.href}}" title="{{val.title}}">{{val.title}}</a></li>{{#if idx%6 == 5}}</ul>{{/if}}{{/each}}',A=null;s.query(".j_CrumbDrop",o).each(function(K){var J=s.get(".j_CrumbDropHd",K),I=s.get(".j_CrumbDropBd",K),H=function(Q){var P={href:"javascript:;",title:J.text||J.textContent||J.innerText,atp:"0,cat-dropdown,,,,"+(J.search.match(/\bcat=\d+/)||[""])[0]+",rightnav,"};Q.unshift(P);s.html(I,g(E).render({data:Q}))},O=function(P,Q){var T=s.outerWidth(P),U=s.innerWidth(Q),R=s.offset(P).left,W=s.offset(Q).left;var S=0;if(T<=U){S=Math.max(W-R,0)||Math.min((W+U)-(R+T),0)}else{}S&&D._resetListPos(false,false,S)},N=function(P){if(K.hover){s.addClass(K,u);O(J,r);var R=I.step||(I.step=s.outerWidth(s.get("ul",I))),Q=s.offset(r).left+v-s.offset(J).left;P=Math.min(Math.floor(Q/R),P);I._initWidth=P*R||I._initWidth||Q;s.css(I,"width",I._initWidth);A=K}},M=function(P){P.hover=false;s.removeClass(P,u);A=null},L="/ajax/getAllBrotherCats.htm"+J.search;if(I){j.UA.ie==7&&J.setAttribute("hideFocus","true");q.on(s.get("i",K),"click",function(P){if(!K.hover){K.hover=true;A&&M(A);if(!!I.rendered){N()}else{j.io.get(L,{t:x?+new Date:0},function(Q){if(Q&&Q.length){H(Q);N(Math.ceil(Q.length/6))}else{s.hide(I);N()}I.rendered=true},"json")}}else{M(K)}P.preventDefault()});q.on(I,"mouseleave",function(P){j.later(function(){M(K)},300)})}})},_crumbAnim:function(){var E=false,A=0,D=s.query("li",C);D.each(function(H){A+=H.offsetWidth;function I(){if(H.className.indexOf("crumbSearch")===-1&&E){s.hide(H);s.css(H,"opacity","0")}}a?H.className.indexOf("crumbAttr")>-1&&(s.hide(H),s.css(H,"opacity","0")):I();E=true});s.hide(s.prev(n));s.css(n,{position:"absolute",left:n.offsetLeft,visibility:"visible"});w(B,{left:A-n.offsetWidth+(a?10:0)},0.6,"easeNone",function(){D.each(function(H){s.show(H);s.css([s.get("a",H),s.get(y,H)],{visibility:"visible"});w(H,{opacity:"1"},1,"easeNone",undefined).run()})}).run()}});return{init:function(){new c()}}},{requires:["template","anim"]});/*pub-1|2013-04-11 10:56:53*/KISSY.add(V+"/mods/filter",function(J,Y){var R=J.DOM,Q=J.Event,i=document,I=window,W=J.UA.ie==6,d=J.get(".main"),K=J.get("#J_Filter"),G=J.get("#J_FForm"),P="filter-fix",M=J.get("#J_FPrice"),C=J.query(".j_FPInput"),U=J.get("#J_FPEnter"),F=J.get("#J_FPCancel"),H="fPrice-hover",Z=J.get("#J_FOriginArea"),O=J.get("#J_FOAInput"),b=J.get("form",Z),a=J.get("button",Z),e=J.get("#J_FDestArea"),B=J.get("#J_DestAreaForm"),g="fA-text",T="fA-list",A="fAll-cities",L="fAl-cur",N="fAll-cities-cur",c=new Y(),h=J.get("#J_FMenu"),X=J.get(".j_FMcExpand");function f(){if(!(this instanceof f)){return new f()}this.isPriceFocus=false;this._init()}J.augment(f,J.EventTarget,{_init:function(){if(!K){return }LIST.msg.fire("ie6Hover",{classname:["fArea","fRange"]});this._priceInit();this._priceEvent();this._originAreaEvent();this._destAreaInit();this._destAreaEvent();this._menuInit();this._menuEvent();this._fix();this._tipCtrl(true);this._disctOpts()},_priceInit:function(){var D=function(E,k){var j=location.search,S=j.match(new RegExp("\\b"+k+"=(\\d+)\\b"));S&&(E.value=S[1])};D(C[0],"start_price");D(C[1],"end_price")},_priceEvent:function(){if(!M){return }var D=this,E=null;Q.on(C,"blur",function(){E=setTimeout(function(){D.isPriceFocus=false;R.removeClass(M,H)},300)});Q.on(C,"focus",function(){clearTimeout(E);D.isPriceFocus=true;R.addClass(M,H)});Q.on(C,"keyup",function(){var S=this.value;if(!/^\d+\.?\d*$/.test(S)){S=Math.abs(parseFloat(S));this.value=isNaN(S)?"":S}});Q.on(U,"click",function(S){G.submit();J.log(G);S.preventDefault()});Q.on(F,"click",function(S){R.val(C,"");C[0].focus();S.preventDefault()});Q.on(K,"keypress",function(S){if(S.keyCode==13&&D.isPriceFocus){G.submit()}})},_originAreaEvent:function(){if(!O){return }var D=R.attr(O,"data-val")||"";if(O.value==""){O.value=D}Q.on(O,"focus",function(){if(O.value==D){O.value=""}});Q.on(O,"blur",function(){if(O.value==""){O.value=D}});Q.on(J.query("a",Z),"click",function(E){E.preventDefault();var S=R.attr(this,"data-val")||R.html(this);O.value=S=="\u6240\u6709\u5730\u533a"?"":S;b.submit()});Q.on(a,"click",function(){if(O.value==D){O.value=""}})},_updateDestAreaBoxHtml:function(j,S,E){var l=['<ul class="fAl-loc">'];for(var D in S){l[l.length]="<li"+((E==D)?' class="'+L+'"':"")+'><a href="" code="'+D+'" atpanel="3,'+S[D]+',,,spu-toloc,20,toloc,">'+S[D]+"</a></li>"}l[l.length]="</ul>";R.html(j,l.join(""))},_data:{},_destAreaInit:function(){if(!e){return }var D=R.get("."+T,e),m=R.get("."+g,e),S=R.query("a",D),s=R.val(B.area_code),j=c[s];if(!j){var n=s.replace(/([\d]{2})\d+/g,"$10000"),E=c[n],q=E&&E.length==2?E[1]:null,l;if(q){for(var k=0,o=S.length;k<o;k++){var p=S[k];if(R.attr(p,"code")==n){var r=p.parentNode;l=R.next(r,"."+A);this._updateDestAreaBoxHtml(l,q,s);if(!R.get("i",p)){R.append(R.create('<i class="f-ico-triangle-mt" />'),p)}R.addClass(r,L);R.addClass(l,N);R.html(m,q[s]);this._data.lastBox=l;this._data.lastLi=r;this._data.lastChildLi=R.get("."+L,l);break}}}}else{for(var k=0,o=S.length;k<o;k++){var p=S[k],r=p.parentNode;if(R.attr(p,"code")==s){R.addClass(r,L);this._data.lastLi=r;break}}}},_destAreaEvent:function(){if(!e){return }var D=this,j=R.get("."+T,e),S=D._data.lastChildLi,k=D._data.lastLi,E=D._data.lastBox;Q.delegate(j,"click","a",function(q){var m=q.currentTarget,l=m.parentNode,n=R.attr(m,"code"),p=[],o=null;if(R.hasClass(l,A)){return }R.addClass(l,L);n&&(p=c[n]||[]);l.grade=p.length!==0?1:2;E&&l.grade==1&&R.removeClass(E,N);p.length==2&&(function(){if(o=R.next(l,"."+A)){D._updateDestAreaBoxHtml(o,p[1]);if(!R.get("i",m)){R.append(R.create('<i class="f-ico-triangle-mt" />'),m)}R.addClass(o,N);E=o}})();switch(l.grade){case 1:if(k!=l){R.removeClass(k,L);k=l}break;case 2:if(S!=l){R.removeClass(S,L);S=l}break}q.preventDefault();if(p.length!==2){R.val(B.area_code,n);B.submit()}})},_menuEvent:function(){if(!h){return }Q.on(J.query("input",h),"click",function(){G.submit()})},_menuInit:function(){if(!h){return }var S="drop",E=R.children(h,function(k){return k.tagName=="INPUT"&&k.type=="checkbox"}),D=E.length;for(var j=3;j<D;j++){if(E[j].checked){S="expand";break}}LIST.msg.fire("expand",{el:X,classname:"fMenu",status:S})},_fix:function(){var S=R.create('<div id="J_FilterPlaceholder" />',{css:{height:R.outerHeight(K,true),display:"none"}});R.insertAfter(S,K);this.needFixTop=true;var E=Math.max(R.offset(K).top,130),D=function(){var j=R.scrollTop(I);if(j>E){if(!R.hasClass(K,P)){R.addClass(K,P);R.show(S)}if(W){R.css(K,"top",j-10-R.offset(d).top)}}else{R.removeClass(K,P);R.hide(S);E=Math.max(R.offset(K).top,130)}};D();Q.on(I,"scroll",D)},_tipCtrl:function(S){if(S||!h){return }var j=R.query("label",h);if(!j.length){return }var E=[1,-1,0,0],D=E.length;J.query(".j_FTip").each(function(o){var l=R.attr(o,"data-cfg"),k=E;if(l){k=l.split(",");for(var n=0;n<D;n++){k[n]=parseInt(k[n])||E[n]}}var m=j[k[0]-1];if(m){var p=m.offsetLeft+R.outerWidth(m)/2-R.outerWidth(o)/2;R.css(o,"left",p+"px")}k[1]!==-1&&setTimeout(function(){R.hide(".j_FTip")},k[1]<0?0:k[1]);k[2]&&R.show(R.get(".j_FTCat",o));k[3]&&R.show(R.get(".j_FTX",o));R.show(o)})},_disctOpts:function(){var D="#J_FDisctOpts";if(!R.get(D)){return }J.UA.ie==7&&R.query(D+" a").each(function(E){E.setAttribute("hideFocus","true")});Q.delegate(D,"click","a",function(j){var S=j.target,E="fDO-cur",k="fDO-disable";if(R.hasClass(S,k)){return }R.query(D+" a").each(function(l){R.removeClass(l,E)});R.addClass(S,E)})}});return{init:function(){new f()}}},{requires:[V+"/city-codes"]});/*pub-1|2013-01-17 10:14:41*/KISSY.add(V+"/mods/dsr",function(F,C){var J=F.DOM,H=F.Event,G='<p class="shopDsr-title">\u5e97\u94fa\u52a8\u6001\u8bc4\u5206<span>\u4e0e\u540c\u884c\u4e1a\u76f8\u6bd4</span></p> <ul class="shopDsr-con">	<li>\u63cf\u8ff0\u76f8\u7b26\uff1a<em class="sDc-num">{{dsValue}}</em>		{{#if dsHigh}} 			<b class="sDc-high">{{dsCpText}}</b><em class="sDc-high">{{dsCompare}}</em>		{{#else}}			<b class="sDc-low">{{dsCpText}}</b><em class="sDc-low">{{dsCompare}}</em>		{{/if}}	</li>	<li>\u670d\u52a1\u6001\u5ea6\uff1a<em class="sDc-num">{{sqValue}}</em>		{{#if sqHigh}} 			<b class="sDc-high">{{sqCpText}}</b><em class="sDc-high">{{sqCompare}}</em>		{{#else}}			<b class="sDc-low">{{sqCpText}}</b><em class="sDc-low">{{sqCompare}}</em>		{{/if}}	</li>	<li>\u53d1\u8d27\u901f\u5ea6\uff1a<em class="sDc-num">{{ssValue}}</em>		{{#if ssHigh}} 			<b class="sDc-high">{{ssCpText}}</b><em class="sDc-high">{{ssCompare}}</em>		{{#else}}			<b class="sDc-low">{{ssCpText}}</b><em class="sDc-low">{{ssCompare}}</em>		{{/if}}	</li><ul>',A='<p>\u670d\u52a1\u6001\u5ea6\uff1a<em class="pId-num">{{sqValue}}</em>	<a target="_blank" atpanel="{{atpanel}}" href="{{rateUrl}}"> 	{{#if sqHigh}} 		<b class="pId-high">{{sqCpText}}</b><em class="pId-high">{{sqCompare}}</em>	{{#else}}		<b class="pId-low">{{sqCpText}}</b><em class="pId-low">{{sqCompare}}</em>	{{/if}}	</a>	<i class="pId-arrow"></i></p><ul class="pId-expand">	<li class="pIde-title"><strong>\u5e97\u94fa\u52a8\u6001\u8bc4\u5206</strong>\u4e0e\u540c\u884c\u4e1a\u76f8\u6bd4</li>	<li>\u63cf\u8ff0\u76f8\u7b26\uff1a<em class="pId-num">{{dsValue}}</em>		<a target="_blank" atpanel="{{atpanel}}" href="{{rateUrl}}"> 		{{#if dsHigh}} 			<b class="pId-high">{{dsCpText}}</b><em class="pId-high">{{dsCompare}}</em>		{{#else}}			<b class="pId-low">{{dsCpText}}</b><em class="pId-low">{{dsCompare}}</em>		{{/if}}		</a>	</li>	<li>\u670d\u52a1\u6001\u5ea6\uff1a<em class="pId-num">{{sqValue}}</em>		<a target="_blank" atpanel="{{atpanel}}" href="{{rateUrl}}"> 		{{#if sqHigh}} 			<b class="pId-high">{{sqCpText}}</b><em class="pId-high">{{sqCompare}}</em>		{{#else}}			<b class="pId-low">{{sqCpText}}</b><em class="pId-low">{{sqCompare}}</em>		{{/if}}		</a>	</li>	<li>\u53d1\u8d27\u901f\u5ea6\uff1a<em class="pId-num">{{ssValue}}</em>		<a target="_blank" atpanel="{{atpanel}}" href="{{rateUrl}}"> 		{{#if ssHigh}} 			<b class="pId-high">{{ssCpText}}</b><em class="pId-high">{{ssCompare}}</em>		{{#else}}			<b class="pId-low">{{ssCpText}}</b><em class="pId-low">{{ssCompare}}</em>		{{/if}}		</a>	</li><ul>',B={cls:".j_ShopDsr",dataUrl:DEV_EV=="demo"||DEV_EV=="local"?"/ajax/dsr.php":(J.val("#J_ShopDsrUrl")||""),expand:false,tpl:G,cpText:["\u4f4e\u4e8e","\u6301\u5e73","\u9ad8\u4e8e"]};function I(D){if(!(this instanceof I)){return new I(D)}this.config=F.merge(B,D||{});this._init()}F.augment(I,F.EventTarget,{_init:function(){if(J.query(this.config.cls).length>0){this._request()}},_request:function(){var D=this,E=D.config.dataUrl;if(!E){return }F.io.get(E,{t:+new Date},function(K){D._render(K)},"json")},_formatData:function(L){if(!(L&&F.isObject(L))){return }var E={},K=this.config.cpText,D=function(M){var O=parseFloat(L[M].compare);var N=E[M+"High"]=O>=0;E[M+"Value"]=L[M].value;E[M+"CpText"]=N?K[2]:K[0];if(O==0){E[M+"Compare"]="---------";E[M+"CpText"]=K[1]}else{if(O>0){E[M+"Compare"]=L[M].compare}else{E[M+"Compare"]=L[M].compare.substr(1)}}};E.rateUrl=L.rateUrl||"";D("ds");D("sq");D("ss");return E},_render:function(L){var E=this,D=E.config,K=D.expand?A:D.tpl;F.each(F.query(D.cls),function(O,M){var N="shop"+(M+1),P=E._formatData(L[N]);P.atpanel=J.attr(O,"data-atpanel")||"";if(P&&F.isObject(P)){J.html(O,C(K).render(P))}});D.expand&&LIST.msg.fire("ie6Hover",{classname:"proInfo-dsr"})}});return{init:function(D){new I(D)},setCfg:function(D){B=F.merge(B,D||{})}}},{requires:["template"]});/*pub-1|2013-01-17 10:14:41*/KISSY.add(V+"/mods/p4p",function(S,T,Lazy){var D=S.DOM,E=S.Event,win=window,requestUrl="http://tmatch.simba.taobao.com",atpanelUrl="http://ac.atpanel.com/1.gif?com=02&apply=list&cod=1.3.1&uid=&ver=&ip=&other=";countMap=[5,6,7],tpl='<div class="recommend">	<h3 class="recommend-hd">\u5546\u5bb6\u70ed\u5356\uff1a</h3>	<div class="recommend-con clearfix recommend-con-{{count}}">	{{#each data as vo loc}}   	<div class="product">       	<a href="{{vo.EURL}}" target="_blank" atpanel="{atpanel}" class="productImg">           	 <img src="{{vo.TBGOODSLINK}}" />        	</a>        	<p class="productPrice ui-price">&yen;{{vo.GOODSPRICE}}</p>        	<p class="productTitle"><a href="{{vo.EURL}}" atpanel="{atpanel}" target="_blank">{{vo.TITLE}}</a></p>    	</div>	{{/each}}	</div></div>';function Recommend(cfg){if(!(this instanceof Recommend)){return new Recommend()}var defaultCfg={conId:"#J_Recommend",dataUrl:requestUrl,tpl:tpl,imgFix:"_160x160.jpg",params:{},callback:"__p4p_request_result"};this.config=S.merge(defaultCfg,cfg||{});this.atpanel="-2,{{vo.RESOURCEID}},,,spu,1,p4p,";this.p4pImgFix="_sum.jpg";this.params={};this.count=5;this.content=null}S.augment(Recommend,S.EventTarget,{init:function(){var self=this,attr,obj,cfg=self.config;self.content=S.get(cfg.conId);if(!self.content){return }attr=D.attr(self.content,"data-p4p-cfg")||{};if(attr){obj=eval("("+attr+")");self.params=self._formatParams(obj);cfg.dataUrl+="?"+self._param(self.params)}self.atpanel=D.attr(self.content,"data-atpanel")||self.atpanel;cfg.tpl=cfg.tpl.replace(/{atpanel}/g,self.atpanel);S.log("p4p request url : "+cfg.dataUrl);self._request()},_param:function(o){var buf=[],key,val;for(key in o){val=o[key];buf.push(key+"="+val)}return buf.join("&")},_formatParams:function(obj){var reverseCat=function(src){if(!src){return""}var strs=src.split(","),result="";for(var i=strs.length;i>=0;i--){if(!!strs[i]){result+=strs[i]+","}}if(result.length>0){result=result.substring(0,result.length-1)}return result};obj.catid=reverseCat(obj.catid);obj.cat=reverseCat(obj.cat);obj.propertyid=reverseCat(obj.propertyid);obj.property=reverseCat(obj.property);obj.refpid=reverseCat(obj.pid);obj.p4p=this.config.callback;obj.t=+new Date;var view=win.g_config.view||0,page=obj.page||1;this.count=obj.count=countMap[view];obj.offset=(page-1)*obj.count;obj=S.merge(obj,this.config.params||{});S.log("p4p request params :");S.log(obj);return obj},_request:function(){var self=this;win[self.config.callback]?self._render():S.getScript(self.config.dataUrl,function(){self._render();self.fire("loadSuccess")})},_render:function(){var self=this,html,obj={},result=win[self.config.callback];if(!(result&&S.isArray(result)&&result.length>0)){return }obj=self._formatData(result);html=T(self.config.tpl).render(obj);D.html(self.content,html);D.show(self.content);self._sendExposure();win[self.config.callback]=null},_formatData:function(arr){var self=this,result=[],hlKeyword=function(str,key){if(!!str&&!!key){var key=key.replace(/[,\s\+]+/g,"|").replace(/(\\)+/g,"$1$1");return str.replace(new RegExp("("+key+")","ig"),"<em>$1</em>")}else{return str}},replaceImg=function(src){return src.replace(self.p4pImgFix,self.config.imgFix)};S.each(arr,function(item,idx){var obj=S.clone(item),params=self.params;obj.TITLE=hlKeyword(obj.TITLE,obj.REDKEY);obj.GOODSPRICE=(obj.GOODSPRICE/100).toFixed(2);obj.TBGOODSLINK=replaceImg(obj.TBGOODSLINK);result.push(obj)});return{data:result,count:this.count}},_sendExposure:function(){try{new Image().src=atpanelUrl+"&cache="+Math.random().toString().slice(2,9)}catch(err){}}});return Recommend},{requires:["template","datalazyload"]});/*pub-1|2013-05-08 14:08:10*/KISSY.add(V+"/mods/attr",function(S,T){var D=S.DOM,E=S.Event,J=S.JSON,doc=document,win=window,isIE6=(S.UA.ie===6);var FORM="#J_FilterNavForm",BRAND=".j_Brand",CATE=".j_Cate",PROP=".j_Prop",ATTR=".attr",MORE_BTN=".j_More",MORE_ATTRS_BTN=".j_MoreAttrs",MORE_ATTRS_CONT=".j_MoreAttrsCont",MULTIPLE_BTN=".j_Multiple",SUBMIT_BTN=".j_SubmitBtn",CANCLE_BTN=".j_CancelBtn",BRAND_SEARCH=".j_BrandSearch",DISABLE_BTN_CLS="ui-btn-disable",VAL_SELECTED_CLS="av-selected",MINI_ATTR_CLS="miniAttr",MINI_ATTRS_CLS="miniAttrs",UL_EXPAND_CLS="av-expand",UL_COLLAPSE_CLS="av-collapse",UL_SCROLL_CLS="av-scroll",FOR_MULTIPLE_CLS="forMultiple",FOR_MULTIPLE_BTN_CLS="forMultipleBtn",MULTIPLE_ROW_CLS="multipleRow",MORE_ATTRS_DROP_CLS="attrExtra-more-drop",SHOW_LOGO_CLS="showLogo",ATTR_TRIGGER="#J_attrTrigger";var form=D.get(FORM),brand=D.get(BRAND,form),cates=D.query(CATE),props=D.query(PROP,form),moreAttrsBtn=D.get(MORE_ATTRS_BTN,form),moreAttrsCont=D.get(MORE_ATTRS_CONT,form),searchUrl=D.attr(D.get(MORE_BTN,brand),"data-url"),logoUrl=D.attr(D.get("."+SHOW_LOGO_CLS,brand),"data-url"),hasTmpTag=D.hasClass(brand,"j_TmpTag");var util={extend:function(obj,base,methodName,func,isFore){if(methodName in base){if(isFore){obj[methodName]=function(){func.apply(this,arguments);base[methodName].apply(this,arguments)}}else{obj[methodName]=function(){base[methodName].apply(this,arguments);func.apply(this,arguments)}}}},bindPlaceholder:function(selector){var inputs=null,placeholderColor="#BFBFBF";if(S.isString(selector)){inputs=D.query(selector)}else{if(S.isObject(selector)){inputs=[selector]}}var typeStr=["text","search","url","tel","email","password"].join(",");S.each(inputs,function(input){if(typeStr.indexOf(input.type)!=-1){if(D.hasAttr(input,"placeholder")){if(S.trim(D.val(input))==""||S.trim(D.val(input))==D.attr(input,"placeholder")){D.css(input,"color",placeholderColor);D.val(input,D.attr(input,"placeholder"))}E.on(input,"focus",function(e){D.css(input,"color","");if(S.trim(D.val(input))==D.attr(input,"placeholder")){D.val(input," ")}});E.on(input,"blur",function(e){if(S.trim(D.val(input))==""){D.css(input,"color",placeholderColor);D.val(input,D.attr(input,"placeholder"))}})}}})},getCustomKey:function(el,key){if(!el||el.tagName!="A"){return}if(el._map&&key in el._map){return el._map[key]}var re=new RegExp("(\\?|\\&)"+key+"=([^&#]*)(\\&|\\#|$)","g"),href=el.href||el.link||"",value,result;value=(result=re.exec(href))?result[2]:D.attr(el,"data-"+key)||"";el._map=el._map||{};el._map[key]=value;return el._map[key]},fixIE6Hover:function(selector,callback){if(isIE6){if(!this._initedHoverCallback){S.mix(this,S.EventTarget);this._selectorRegs={cls:/^[.][_a-z]+[-_0-9a-z]*$/i,cls_tag:/^([.][_a-z]+[-_0-9a-z]*)( )+([a-z]+)$/i,id_tag:/^[#][_a-z]+[-_0-9a-z]*( )+[a-z]+$/i};this._hoverEventFns={add:function(selector,callback){var hoverCls=selector.replace(/[.#]/g,"")+"-hover";E.on(selector,"mouseenter",function(e){D.addClass(this,hoverCls);callback&&callback.call(this,e)});E.on(selector,"mouseleave",function(e){D.removeClass(this,hoverCls);callback&&callback.call(this,e)})},delegate:function(selector,filter,callback){var hoverCls=filter.replace(/[.#]/g,"")+"-hover";E.delegate(selector,"mouseenter",filter,function(e){D.addClass(e.currentTarget,hoverCls);callback&&callback.call(e.currentTarget,e)});E.delegate(selector,"mouseleave",filter,function(e){D.removeClass(e.currentTarget,hoverCls);callback&&callback.call(e.currentTarget,e)})}};var self=this,bindEvent=function(selector,callback){var regs=self._selectorRegs,fns=self._hoverEventFns;if(regs.cls.test(selector)){fns.add(selector,callback);S.log('mod:Attr::fixIE6Hover succeeded for "'+selector+'"!')}else{if(regs.cls_tag.test(selector)){var res=selector.match(regs.cls_tag);fns.delegate(res[1],res[3],callback);S.log('mod:Attr::fixIE6Hover succeeded for "'+selector+'"!')}else{if(regs.id_tag.test(selector)){var res=selector.match(regs.id_tag);fns.delegate(res[1],res[3],callback);S.log('mod:Attr::fixIE6Hover succeeded for "'+selector+'"!')}else{S.log('mod:Attr::fixIE6Hover failed for "'+selector+'"!',"error")}}}};this.on("ie6Hover",function(e){var selector=e.selector,callback=e.callback;if(!selector){return}else{if(S.isString(selector)){bindEvent(selector,callback)}else{if(S.isArray(selector)){S.each(selector,function(item){bindEvent(item,callback)})}}}});this._initedHoverCallback=true}this.fire("ie6Hover",{selector:selector,callback:(callback&&S.isFunction(callback))?callback:null})}},reviseImg:function(src,prefix,suffix,clean){if(!src){return src}else{if(src.indexOf("taobaocdn")===-1){src=src.replace(/([^\/]*\/)*i\d\//,"");var codeSum=0;for(var i=0,len=src.length;i<len;i++){codeSum+=src.charCodeAt(i)}codeSum%=4;codeSum+=1;if("number"===typeof prefix){clean=suffix;suffix=prefix;prefix=null}else{if("string"===typeof prefix){switch(prefix){case"tps":case"imgextra":case"bao/uploaded":case"poster_pic":break;default:clean=suffix;suffix=prefix;prefix=null}}else{if("boolean"===typeof prefix){clean=prefix;prefix=null}}}src="http://img0"+codeSum+".taobaocdn.com/"+(prefix||"tps")+"/i"+codeSum+"/"+src}if("number"===typeof suffix){suffix=suffix+"x"+suffix}if(suffix){src=src.replace(/(\.\w+)_\w+\1$/,"$1");var matches=suffix.match(/\.\w+$/)||src.match(/\.\w+$/);src=src+"_"+suffix.replace(/_|\.\w*/g,"")+(matches.length?matches[0]:"jpg")}return clean?src.replace(/i\d\/([^\/]+\/)*/gi,""):src}}};var moreBtn={init:function(attr){var minDiffRow=attr.minDiffRow||1,as=attr.valueAnchors,offsetHeight=as.length?Math.max(as[0].offsetHeight,parseFloat(D.css(as[0],"lineHeight"))):25;if(attr.moreBtn){!S.trim(new RegExp("((.|\n)*)<i","gi").exec(attr.moreBtn.innerHTML)[1])&&(attr.moreBtn.innerHTML=(D.hasClass(attr.ul,UL_EXPAND_CLS)?"\u6536\u8d77":"\u66f4\u591a")+attr.moreBtn.innerHTML);var hasToggleState=D.hasClass(attr.ul,UL_COLLAPSE_CLS)||D.hasClass(attr.ul,UL_EXPAND_CLS),unopenMultiple=!attr.openMultiple,isVisible=D.style(attr.moreBtn,"visibility")=="visible",moreThanMinRow=(as.length?(as[as.length-1].offsetTop-as[0].offsetTop):0)>=minDiffRow*offsetHeight,hasMiniAttr=D.hasClass(attr.parentNode,MINI_ATTR_CLS),forMiniAttr=hasMiniAttr&&attr.multipleBtn;if(hasToggleState&&unopenMultiple&&(isVisible||moreThanMinRow||forMiniAttr)){if(D.hasClass(attr.ul,UL_EXPAND_CLS)){moreBtn.open(attr)}moreBtn.show(attr);attr.moreBtn.shouldShow=true;hasMiniAttr&&D.addClass(attr.ul,MULTIPLE_ROW_CLS)}else{moreBtn.hide(attr);attr.moreBtn.shouldShow=false}}else{D.style(attr.ul,"height","auto")}},close:function(attr){if(attr.moreBtn){D.addClass(attr.moreBtn,"ui-more-drop-l");D.removeClass(attr.moreBtn,"ui-more-expand-l");var html=D.html(attr.moreBtn);html=html.replace("\u6536\u8d77","\u66f4\u591a");html=html.replace("expand","drop");D.html(attr.moreBtn,html)}},open:function(attr){if(attr.moreBtn){D.addClass(attr.moreBtn,"ui-more-expand-l");D.removeClass(attr.moreBtn,"ui-more-drop-l");var html=D.html(attr.moreBtn);html=html.replace("\u66f4\u591a","\u6536\u8d77");html=html.replace("drop","expand");D.html(attr.moreBtn,html)}},show:function(attr){attr.moreBtn&&D.show(attr.moreBtn)},hide:function(attr){attr.moreBtn&&D.hide(attr.moreBtn)}};var multipleBtn={init:function(attr){D.hasClass(attr.parentNode,MINI_ATTR_CLS)&&attr.multipleBtn&&D.addClass(attr.ul,FOR_MULTIPLE_BTN_CLS)},show:function(attr){if(attr.multipleBtn){D.show(attr.multipleBtn);attr.multipleBtn.isHidden=false}},hide:function(attr){if(attr.multipleBtn){D.hide(attr.multipleBtn);attr.multipleBtn.isHidden=true}}};var formBtns={show:function(attr){attr.submitBtn&&D.show(attr.submitBtn.parentNode)},hide:function(attr){attr.submitBtn&&D.hide(attr.submitBtn.parentNode)}};var list={collapse:function(attr){D.replaceClass(attr.ul,UL_EXPAND_CLS,UL_COLLAPSE_CLS);D.scrollTop(attr.ul,0)},expand:function(attr){D.replaceClass(attr.ul,UL_COLLAPSE_CLS,UL_EXPAND_CLS)},openMultiple:function(attr){this.expand(attr);multipleBtn.hide(attr);moreBtn.hide(attr);formBtns.show(attr);D.addClass(attr,FOR_MULTIPLE_CLS);attr.openMultiple=true},close:function(attr){this.collapse(attr);this._clearValSelectedCls(attr);this._disableSubmitBtn(attr);formBtns.hide(attr);D.removeClass(attr,FOR_MULTIPLE_CLS);attr.openMultiple=false;multipleBtn.show(attr);if(attr.moreBtn&&attr.moreBtn.shouldShow){moreBtn.close(attr);moreBtn.show(attr)}},closeAll:function(attrs){S.each(attrs,function(attr){this.close(attr)},this)},_clearValSelectedCls:function(attr){S.each(attr.valueAnchors,function(val){D.removeClass(val.parentNode,VAL_SELECTED_CLS)})},_disableSubmitBtn:function(attr){if(attr.submitBtn&&!D.hasClass(attr.submitBtn,DISABLE_BTN_CLS)){D.addClass(attr.submitBtn,DISABLE_BTN_CLS);attr.valueAnchors.selectedCount=0}}};var ajax=S.merge(S.EventTarget,{initLogos:function(handler,attr){var self=this,ids=[],reg=/(\?|&)brand=(\d*)\b/i,timestamp=isIE6?+new Date:0;S.each(attr.valueAnchors,function(val){var res=val.search.match(reg);ids[ids.length]=val._brandId=D.attr(val,"data-id")||(res&&res.length==3)?res[2]:""});logoUrl&&S.io.get(logoUrl,(logoUrl.indexOf("brand_ids=")!==-1)?{t:timestamp}:{brand_ids:ids.join(","),t:timestamp},function(data){S.each(attr.valueAnchors,function(val){var logo=util.reviseImg(data[val._brandId]);logo&&D.prepend(D.create('<img src="'+logo+'" alt="'+(val.text||val.innerText)+'" />'),val)})},"json")},expandBrand:function(handler,attr){D.show(attr.brandSearch);if(attr.ajaxData){this.replaceUlHtml(attr,attr.ajaxData);handler.bindEventForValue(attr)}else{!attr.ulCopy&&(attr.ulCopy=D.clone(attr.ul,true,true,true));this.searchAndRender(handler,attr)}},collapseBrand:function(handler,attr){var keywordInput=D.get("input",brand.brandSearch);D.val(keywordInput,"");E.fire(keywordInput,"blur");D.hide(attr.brandSearch);this.replaceUlHtml(attr,"");D.prepend(D.children(D.clone(attr.ulCopy,true,true,true)),attr.ul)},searchAndRender:function(handler,attr,key,callback){var self=this;D.style(attr.ul,"visibility","hidden");if(!self._initedSearchCallBack){self.on("render",function(e){var result=e.result,key=e.key,attr=e.attr;self.replaceUlHtml(attr,result);this.bindEventForValue(attr);D.style(attr.ul,"visibility","visible");!S.trim(key)&&(attr.ajaxData=result)},handler);self._initedSearchCallBack=true}self._search(attr,searchUrl,key,callback)},_search:function(attr,dataUrl,key,callback){var self=this;dataUrl&&S.io.get(dataUrl,S.trim(key)?{brandkey:encodeURIComponent(S.trim(key)),t:isIE6?+new Date:0}:{t:isIE6?+new Date:0},function(data){callback&&callback();self.fire("render",{result:self.render(data),key:key,attr:attr})})},_searchTip:"\u62b1\u6b49\uff0c\u6ca1\u6709\u627e\u5230\u76f8\u5173\u54c1\u724c",render:function(data){var tpl='{{#each data as val idx}}<li><a atpanel="{{val.atpanel}}" href="{{val.href}}" title="{{val.title}}">{{#if val.img !==undefined && val.img !== ""}}<img src="http://img01.taobaocdn.com/bao/uploaded/{{val.img}}"/>{{/if}}{{val.title}}</a></li>{{/each}}';data=eval(data);var html=(html=T(tpl).render({data:data}))?html.replace(/title=(["'])[^"']*\1/g,function($){return $.replace(/<\/?strong>/g,"")}):"";if(data.length==0){html=this._searchTip}return html},replaceUlHtml:function(attr,str){this.detachEventsForValue(attr);D.html(attr.ul,str);this.correctStyle(attr)},appendUlHtml:function(attr,str){this.detachEventsForValue(attr);D.html(attr.ul,D.html(D.clone(attr.ulCopy,true,true,true))+str);this.correctStyle(attr)},detachEventsForValue:function(attr){S.each(attr.valueAnchors,function(val){E.detach(val,"click")})},correctStyle:function(attr){D.removeClass(attr.ul,UL_SCROLL_CLS);if(isIE6&&typeof attr.ul.initHeight!=="undefined"){D.style(attr.ul,"height",attr.ul.initHeight)}attr.valueAnchors=D.query("a",attr.ul);if(attr.valueAnchors.length==0){return}var cell=attr.valueAnchors[0].parentNode,celWidth=D.outerWidth(cell,true),column=Math.floor(attr.ul.offsetWidth/celWidth),row=attr.valueAnchors.length/column;if(row>5){if(isIE6){attr.ul.initHeight=D.style(attr.ul,"height");D.style(attr.ul,"height","")}D.addClass(attr.ul,UL_SCROLL_CLS)}}});var Base={init:function(extraFn){this.scope&&S.each(this.scope,function(attr){attr.ul=D.get("ul",attr);attr.valueAnchors=D.query("a",attr.ul);attr.multipleBtn=D.get(MULTIPLE_BTN,attr);attr.moreBtn=D.get(MORE_BTN,attr);attr.submitBtn=D.get(SUBMIT_BTN,attr);attr.cancelBtn=D.get(CANCLE_BTN,attr);moreBtn.init(attr);multipleBtn.init(attr);this._bindEvents(attr);extraFn&&S.isFunction(extraFn)&&extraFn.call(this,attr)},this)},_bindEvents:function(attr){this.bindEventForMultipleBtn(attr);this.bindEventForMoreBtn(attr);this.bindEventForValue(attr);this.bindEventForCancelBtn(attr);this.bindEventForSubmitBtn(attr)},bindEventForMultipleBtn:function(attr){attr.multipleBtn&&E.on(attr.multipleBtn,"click",function(e){list.closeAll(this.scope);list.openMultiple(attr)},this)},bindEventForMoreBtn:function(attr){attr.moreBtn&&E.on(attr.moreBtn,"click",function(e){if(D.hasClass(attr.ul,UL_COLLAPSE_CLS)){list.expand(attr);moreBtn.open(attr)}else{if(D.hasClass(attr.ul,UL_EXPAND_CLS)){list.collapse(attr);moreBtn.close(attr)}else{}}})},bindEventForValue:function(attr){attr.valueAnchors.selectedCount=0;attr.submitBtn&&D.addClass(attr.submitBtn,DISABLE_BTN_CLS);S.each(attr.valueAnchors,function(val){E.on(val,"click",function(){if(attr.multipleBtn&&attr.multipleBtn.isHidden&&D.hasClass(attr.ul,UL_EXPAND_CLS)){if(D.html(val).indexOf("<i></i>")==-1){D.html(val,D.html(val)+"<i></i>")}if(!D.hasClass(val.parentNode,VAL_SELECTED_CLS)){D.addClass(val.parentNode,VAL_SELECTED_CLS);attr.valueAnchors.selectedCount++}else{D.removeClass(val.parentNode,VAL_SELECTED_CLS);attr.valueAnchors.selectedCount--}if(attr.submitBtn){if(attr.valueAnchors.selectedCount>0){D.removeClass(attr.submitBtn,DISABLE_BTN_CLS)}else{if(!D.hasClass(attr.submitBtn,DISABLE_BTN_CLS)){D.addClass(attr.submitBtn,DISABLE_BTN_CLS)}}}return false}})})},submit:function(attr){},bindEventForSubmitBtn:function(attr){attr.submitBtn&&E.on(attr.submitBtn,"click",function(e){if(!D.hasClass(attr.submitBtn,DISABLE_BTN_CLS)){this.submit(attr)}return false},this)},bindEventForCancelBtn:function(attr){attr.cancelBtn&&E.on(attr.cancelBtn,"click",function(e){list.close(attr)})}};function Handler(scope){if(!scope){return}!S.isArray(scope)&&(scope=[scope]);this.scope=scope}S.augment(Handler,Base);var bindEventForMoreAttrsBtn=function(){E.on(moreAttrsBtn,"click",function(e){var attrs=[];if(moreAttrsCont.style.display=="none"){D.addClass(moreAttrsBtn,MORE_ATTRS_DROP_CLS);D.html(moreAttrsBtn,D.html(moreAttrsBtn).replace("\u66f4\u591a\u9009\u9879","\u7cbe\u7b80\u9009\u9879"));D.show(moreAttrsCont);attrs=attrs.concat(D.query(ATTR,moreAttrsCont));var miniAttrses=D.query("."+MINI_ATTRS_CLS);S.each(miniAttrses,function(miniAttrs){D.replaceClass(miniAttrs,MINI_ATTRS_CLS,"_"+MINI_ATTRS_CLS);S.each(D.query("."+MINI_ATTR_CLS,miniAttrs),function(miniAttr){D.replaceClass(miniAttr,MINI_ATTR_CLS,"_"+MINI_ATTR_CLS);var attr=D.get(ATTR,miniAttr);attrs[attrs.length]=attr})})}else{D.removeClass(moreAttrsBtn,MORE_ATTRS_DROP_CLS);D.html(moreAttrsBtn,D.html(moreAttrsBtn).replace("\u7cbe\u7b80\u9009\u9879","\u66f4\u591a\u9009\u9879"));D.hide(moreAttrsCont);var miniAttrses=D.query("._"+MINI_ATTRS_CLS);S.each(miniAttrses,function(miniAttrs){D.replaceClass(miniAttrs,"_"+MINI_ATTRS_CLS,MINI_ATTRS_CLS);S.each(D.query("._"+MINI_ATTR_CLS,miniAttrs),function(miniAttr){D.replaceClass(miniAttr,"_"+MINI_ATTR_CLS,MINI_ATTR_CLS);attrs[attrs.length]=D.get(ATTR,miniAttr)})});list.closeAll(attrs)}S.each(attrs,function(attr){moreBtn.init(attr)})})};return{init:function(){S.UA.ie==7&&D.query(ATTR).each(function(attr){D.query("a",attr).each(function(a){a.setAttribute("hideFocus","true")})});S.each(cates,function(attr){attr.minDiffRow=2});var handlerForCates=new Handler(cates);handlerForCates.init();if(!form){return}bindEventForMoreAttrsBtn();var handlerForProps=new Handler(props);handlerForProps.submit=function(attr){var KEY="prop",key="",values=[];S.each(attr.valueAnchors,function(val){if(D.hasClass(val.parentNode,VAL_SELECTED_CLS)){var pv=D.attr(val,"data-pv"),fragments=(pv||"").split(":");key=fragments[0];fragments[1]&&values.push(fragments[1])}});var str=key==""?"":key+":"+values.join(",");var v=D.val(form.prop);D.val(form.prop,v==""?str:v+";"+str);form.submit()};handlerForProps.init();var handlerForBrand=new Handler(brand);util.extend(handlerForBrand,handlerForProps,"bindEventForMoreBtn",function(attr){attr.moreBtn&&E.on(attr.moreBtn,"click",function(e){if(D.hasClass(attr.ul,UL_EXPAND_CLS)){ajax.expandBrand(this,attr)}else{ajax.collapseBrand(this,attr)}},this)});util.extend(handlerForBrand,handlerForProps,"bindEventForMultipleBtn",function(attr){attr.multipleBtn&&E.on(attr.multipleBtn,"click",function(e){ajax.expandBrand(this,attr)},this)});util.extend(handlerForBrand,handlerForProps,"bindEventForCancelBtn",function(attr){E.on(attr.cancelBtn,"click",function(e){ajax.collapseBrand(this,attr)},this)},true);handlerForBrand.submit=function(attr){var value=[];S.each(attr.valueAnchors,function(val){if(D.hasClass(val.parentNode,VAL_SELECTED_CLS)){value.push(util.getCustomKey(val,"brand"))}});D.val(form.brand,value.join(","));form.submit()};if(brand){brand.minDiffRow=2;brand.brandSearch=D.get(BRAND_SEARCH,brand);var searchTimer=null,keywordInput=D.get("input",brand.brandSearch);util.bindPlaceholder(keywordInput);E.on(brand.brandSearch,"keyup",function(e){var keyword=D.val(keywordInput);if(S.trim(keyword)!==S.trim(keywordInput.lastVal)){clearTimeout(searchTimer);searchTimer=setTimeout(function(){ajax.searchAndRender(handlerForBrand,brand,keyword)},200);keywordInput.lastVal=keyword}})}handlerForBrand.init(function(attr){});util.fixIE6Hover(["."+MINI_ATTR_CLS,BRAND+" li"]);if(D.get("."+MINI_ATTRS_CLS,form)){var miniAttrs=D.query("."+MINI_ATTR_CLS,form);var z=parseInt(D.css(miniAttrs[0],"zIndex"));S.each(miniAttrs,function(miniAttr){E.on(miniAttr,"mouseleave",function(e){var el=D.get("."+FOR_MULTIPLE_CLS,miniAttr);if(el){D.style(miniAttr,"zIndex",11)}else{D.style(miniAttr,"zIndex","")}})})}var attrs=[].concat(cates,props);if(brand){attrs.push(brand)}LIST.msg.on("viewchange",function(e){S.each(attrs,function(attr){moreBtn.init(attr)})});E.on(ATTR_TRIGGER,"click",function(e){var _target=e.target;var panelForHide=D.next(_target);D.toggleClass(_target,"expand");_target.className.indexOf("expand")===-1?D.show(panelForHide):D.hide(panelForHide)})}}},{requires:["template"]});/*pub-1|2013-05-09 12:45:19*/KISSY.add(V+"/mods/item-sku",function(b){var h=b.DOM,f=b.Event,n=b.get("#J_ItemList"),j=".productImg",i=".productThumb",c=".proThumb-img",o="miniView",g="proThumb-selected",a="j_ProThumbPrev",l="j_ProThumbNext",r="proThumb-disable",m="data-sku",e="_30x30.jpg",k="_b.jpg",d="_160x160.jpg",p=k;function q(){if(!(this instanceof q)){return new q()}this._init()}b.augment(q,{_init:function(){this._viewChange(true);this._setAllBtnsStatus();this._bindEvents()},_bindEvents:function(){var s=this;f.delegate(n,"mouseenter",i,function(v){var u=v.currentTarget,t=b.query(c,u),w=t.length>s.steps;if(!u.inited){u.inited=true;s._thumb(u,t);w&&s._carousel(u)}if(u.needResetCarousel){s._detachCarousel(u);w&&s._carousel(u);u.needResetCarousel=false}})},_adjustViewIdx:function(w){var t=w.car;if(t){var u=w.activeIdx||0,s=this.steps||1,v=~~(u/s);t.switchTo(v*s/t.config.steps);w.targetIdx=v}},_setAllBtnsStatus:function(){var s=this;h.query(i).each(function(u){var t=b.query(c,u),v=t.length>s.steps;s._setBtnStatus(u,v)})},_setBtnStatus:function(t,v){var u=b.get("."+a,t),s=b.get("."+l,t);if(!u||!s){return}if(v){h.css([u,s],"visibility","visible")}else{h.css([u,s],"visibility","hidden")}},_detachCarousel:function(s){if(s.car){s.car.detach();f.detach(h.get("."+a,s));f.detach(h.get("."+l,s));s.car=null}},_carousel:function(t){var s=this;b.log("sku carousel start init ...");b.use("switchable",function(v,u){t.car=new u.Carousel(t,{effect:"scrollx",steps:s.steps,viewSize:[s.width],circular:false,prevBtnCls:a,nextBtnCls:l,disableBtnCls:r,hasTriggers:false,lazyDataType:"img-src",switchTo:t.targetIdx||0})})},_viewChange:function(u){var s=this,t=function(){var w=h.hasClass(n,o);p=w?d:k;var x=s.steps;s.steps=w?3:5;s.width=w?111:185;var v=(x!==undefined)&&(x!==s.steps);h.query(i).each(function(y){(y.needResetCarousel=v||(y.car&&y.car.config.steps!==s.steps))&&s._adjustViewIdx(y)});v&&s._setAllBtnsStatus()};u&&t();LIST.msg.on("viewchange",t)},_thumb:function(w,v){var t=this,x=b.get(j,w.parentNode),u=b.get("img",x),s=function(y){return !!b.get("i",y)};b.each(v,function(z,y){z.idx=y;if(!s(z)){h.append(h.create("<i>"),z)}});f.on(v,"click",function(y){var A=this,z=b.get("img",A).src;b.each(v,function(B){h.removeClass(B,g)});h.addClass(A,g);w.activeIdx=A.idx;u.src=z.replace(e,p);x.href=t._addParam(h.attr(A,m),x.href)})},_addParam:function(u,t){var v=/(\?|\&)sku_properties=(.*)(\&|$)/,s;s=v.test(t)?t.replace(v,"$1sku_properties="+u+"$3"):t+"&sku_properties="+u;return s}});return{init:function(){new q()}}});/*pub-1|2013-04-16 10:34:41*/KISSY.add(V+"/mods/product",function(d){var g=d.DOM,e=d.Event,h=g.val("#J_ProductDsr"),f=d.query(".j_ProDsr"),c=d.query(".j_ProOrderTime");function b(){if(!(h&&f.length>0)){return}var i={"1":"TOP20","2":"\u9ad8\u4e8e\u5e73\u5747\u6c34\u5e73"};d.io({url:h+"?t="+ +new Date,type:"post",success:function(j){d.each(f,function(n,l){var m="",k,o=j["productDSR"+(l+1)];if(o.level){k=i[o.level]||"";m="\u6ee1\u610f\u5ea6"+o.Score+"<em>"+k+"</em>"}g.html(n,m)})},dataType:"json"})}function a(){if(!(c&&c.length)){return}var i=function(o){if(!o){return""}var q=o.substr(0,4)||"0000";var p=o.substr(4,2)||"00";var n=o.substr(6,2)||"00";var l=o.substr(8,2)||"00";var j=o.substr(10,2)||"00";var k=o.substr(12,2)||"00";return{y:parseInt(q,10),M:parseInt(p,10),d:parseInt(n,10),h:parseInt(l,10),m:parseInt(j,10),s:parseInt(k,10)}};d.each(c,function(j){d.use(V+"/widget/timer",function(p,q){var o=i(g.attr(j,"data-now")||"");var l=i(g.attr(j,"data-end")||"");var r=i(g.attr(j,"data-start")||"");o=new Date(o.y,o.M,o.d,o.h,o.m,o.s).getTime();l=new Date(l.y,l.M,l.d,l.h,l.m,l.s).getTime();r=new Date(r.y,r.M,r.d,r.h,r.m,r.s).getTime();var n=function(t){var s=g.parent(t,"p");var u=g.parent(t,".product");g.addClass(s,"productOrder-end");g.html(s,"<i></i><em>\u9884\u552e\u7ed3\u675f</em>");g.css(s,"width","auto");g.hide(p.get(".productPrice-tips",u))};var m=function(u){var s=g.parent(u,"p");var t=g.get("em",s);console.log(s);t&&g.html(t,"\u5373\u5c06\u5f00\u59cb")};var k=function(s,t,v){var u=(s-t)/1000;new q({leftTime:u,container:j,tpl:u<=86400?"{h}:{m}:{s}":"{d}\u5929 {h}:{m}:{s}"}).run().onStop(function(){v()})};if(r>o){m(j);k(r,o,function(){k(l,o,function(){n(j)})})}else{if(o>=l){n(j)}else{k(l,o,function(){n(j)})}}})})}return{init:function(){b();a()}}});/*pub-1|2013-01-17 10:14:40*/KISSY.add(V+"/mods/list-view",function(C,A){var H=C.DOM,G=C.Event;function F(){var D=["ui-more-drop-l","ui-more-drop-l-arrow"],I=["ui-more-expand-l","ui-more-expand-l-arrow"],K,E,J=function(M,L){H.replaceClass(K,M[0],L[0]);H.replaceClass(E,M[1],L[1])};G.on(".j_Pro","mouseenter mouseleave",function(M){var L=this;K=H.get(".j_ProInfoSPUHd",L);if(K){E=H.get("i",K);if(M.type==="mouseenter"){J(D,I)}else{J(I,D)}}})}function B(){if(C.UA.ie==6){G.on(".j_ProInfoSPUBd","mouseenter",function(D){if(this.inited){G.detach(this,"mouseenter")}else{G.on(C.query("li",this),"mouseenter mouseleave",function(E){if(E.type=="mouseenter"){H.addClass(this,"li-hover")}else{H.removeClass(this,"li-hover")}});this.inited=true}});G.on(".j_Pro","mouseenter",function(){H.addClass(this,"product-hover")});G.on(".j_Pro","mouseleave",function(){H.removeClass(this,"product-hover")})}}return{init:function(){F();B();A("#J_ItemList",{mod:"manual",diff:0})}}},{requires:["datalazyload"]});/*pub-1|2013-04-11 10:56:52*/KISSY.add(V+"/mods/ald03046",function(C){var P=C.DOM,M=C.Event,A=window,Z=document,B=C.all,T=C.UA.ie==6,Q=C.UA.ie<9,R=C.UA.ie<8;var N=15,O=[4,5,6],H=function(){var D=(A.g_config.view||0)!==0&&!!P.get(".hasAld");return O[A.g_config.view||0]-(D?1:0)},K=H(),W=P.get("#J_ItemList"),I=P.query(".product",W),U=function(D){return Math.min((parseInt(D/K)+1)*K-1,I.length-1)},Y=null,L=function(l){var e=P.get(".productImg",l),g=l.lastSku=P.get(".proThumb-selected",l),h=g?P.attr(g,"data-sku"):"",m=h?h.split(":"):[],j=m.length?m[1]:"",c=g?P.get("img",g):P.get("img",e),n=c?c.src.substring(c.src.lastIndexOf("/")+1).replace(/(_30x30\.jpg)|(_b\.jpg)/gi,""):"";if(!l.aldParams){var i=e.tagName=="A"?e:P.get("a",e),E=P.attr(i,"atpanel"),f=(E||"").split(","),S=f.length==8?{itemId:f[1],bakCatId:f[2],shopId:f[7]}:{itemId:"",bakCatId:"",shopId:""},b=P.get(".productAttrs",l),k=b?P.query("a",b):[],d=k.length?k[0].href.match(/[?&]brand=(\d+)\b/i):[],D=d.length?d[1]:"";l.aldParams={itemId:S.itemId,catId:S.bakCatId,brandId:D,num:O[O.length-1],mods:N}}return C.merge(l.aldParams,{imgUrl:n,skuId:j,lastItemId:Y&&Y.aldParams?Y.aldParams.itemId:""})},X=function(E){if(!A.ALD){C.getScript(ALD_INIT_JS_URL,function(){X(E)})}else{var D="03046";ALD.load(D,function(a){var b={params:L(E),render:E.ald,appId:D,effect:"tab",extra:{atpanel:"{idx},{itemId},,,item,1,,{shopId}"}};ALD.util.mockup(b);var S=new a(b);!S.on&&C.mix(S,C.EventTarget);S.on("ald-"+b.appId+"Rendered",function(c){if(!!C.trim(P.html(P.get(".ald-03046",E.ald)))){E.slideHeight=E.aldHeight}else{E.slideHeight=0}E.slideDown()});ALD.request(b,function(c,d){S.setData(c);S.exec();E.innerCssFix()})})}},G={aldHeight:436,vOffset:0,insertAldContainer:function(){if(this.hasAldContainer){return }var D=this,E=this.vOffset=(function(S){return(P.offset(D.container).top-P.offset(D).top)+(P.outerHeight(D.container)-P.outerHeight(D))+S})(25);P.append(D.ald,D.container);P.css(D.ald,{display:"none",clear:"both",height:D.aldHeight,position:"absolute",top:P.outerHeight(D)+E,minWidth:1024});D.wrapperCssFix();D.hasAldContainer=true},scrollIntoView:function(){var E=(P.offset(I[this.refIdx]).top+P.outerHeight(I[this.refIdx])-P.scrollTop(A)),D=P.viewportHeight(),e=Math.ceil((D-this.aldHeight)/2),S=(E+=(!!Y&&Y.refIdx<this.refIdx)?0:this.aldHeight)>D?E+e-D:0;S&&C.Anim(A,{scrollTop:P.scrollTop(A)+S},{queue:false}).run()},slideDown:function(){this.toggle=true;P.addClass(this,"product-hover");T&&(this.disableHoverOut=true);if(!!Y&&Y!==this){P.removeClass(Y,"product-hover");T&&(Y.disableHoverOut=false)}if(Q){!!Y&&(Y.refIdx!==this.refIdx)&&(I[Y.refIdx].style.marginBottom=0);I[this.refIdx].style.marginBottom=(this.slideHeight||0)+this.vOffset+"px";this.ald.style.height=(this.slideHeight||0)+"px";this.ald.style.display=""}else{!!Y&&(Y.refIdx!==this.refIdx)&&C.Anim(I[Y.refIdx],{marginBottom:0}).run();C.Anim(I[this.refIdx],{marginBottom:(this.slideHeight||0)+this.vOffset},1,"easeOut").run();!!this.slideHeight&&B(this.ald).slideDown(1)}!this.slideHeight&&P.css(this.ald,{display:"none"});Y=this},slideUp:function(){this.toggle=false;P.removeClass(this,"product-hover");T&&M.on(this,"mouseleave",function(S){var a=this._events.mouseleave;for(var E=0,D=a.length;E<D;E++){a[E].call(this)}});if(Q){(!Y||Y==this)&&(I[this.refIdx].style.marginBottom="0px");this.ald.style.height="0px";this.ald.style.display="none"}else{(!Y||Y==this)&&C.Anim(I[this.refIdx],{marginBottom:0},1.2,"easeOut").run();B(this.ald).slideUp(1)}Y=null},fadeIn:function(){this.toggle=true;B(this.ald).fadeIn(1)},fadeOut:function(){this.toggle=false;B(this.ald).fadeOut(1)},wrapperCssFix:function(){P.css(this.ald,{marginLeft:-P.offset(this).left-5,width:P.viewportWidth()})},innerCssFix:function(){P.css(P.get(".ald-inner",this),{width:P.innerWidth(W)});P.css(P.get(".ald-arrow",this),{left:(this.idx%K+0.5)*P.outerWidth(this,true)})}},J=function(){LIST.msg.on("viewchange",function(S){K=H();var E,D;if(Y){E=I[Y.refIdx];C.log("ref:"+Y.refIdx);D=P.css(E,"marginBottom");P.css(E,"marginBottom","0")}C.log("width:"+P.viewportWidth()+" |"+P.innerWidth(W));I.each(function(b,a){b.refIdx=U(a);b.innerCssFix()});if(Y){E=I[Y.refIdx];C.log("refIdx:"+Y.refIdx);P.css(E,"marginBottom",D)}});M.on(A,"resize",function(D){Y&&Y.wrapperCssFix()})};function F(E,S){function D(){C.use(V+"/widget/featureguider",function(a,b){S(b.create(E))})}if(!/showGuider=1/.test(location.href)&&E&&E.id){C.use(V+"/widget/local-storage",function(b,c){if(!c.getItem("ts_fg_"+E.id)){var a=E&&E.onHide;E.onHide=function(){c.setItem("ts_fg_"+E.id,b.now());a()};D()}})}else{D()}}return{init:function(){var D=this;C.ready(function(){if(!P.get(".j_MoreSimilar")){return }P.addStyleSheet(".j_SimilarRec .ald-03046{background:#EEEEEB;border:1px solid #dcdbda;box-shadow:inset 1px 1px 3px #E6E5E6;}.ald-03046 .ald-inner .ald-itemlist li{_display:inline;margin-left:8px;margin-right:8px;}");var a=function(g,d){var c=d.collapseAnim,f=P.get(".proThumb-selected",g);!!Y&&Y!=g&&Y.toggle&&a(Y,{collapseAnim:"fadeOut"});if(!g.toggle){g.scrollIntoView();if(g.lastSku!==f){g.insertAldContainer();X(g)}else{if(g.slideHeight){g.wrapperCssFix()}g.slideDown()}}else{if(c=="fadeOut"){g.fadeOut()}else{g.slideUp()}}g.similarBtn.expandSwitchFn()};I.each(function(d,c){C.mix(d,C.merge(G,{ald:P.create('<div class="j_SimilarRec">'),container:P.children(d,"div"),idx:c,refIdx:U(c)}));LIST.msg.fire("expand",{el:d.similarBtn=P.get(".j_MoreSimilar",d),text:{drop:"\u67e5\u770b\u76f8\u4f3c\u5546\u54c1 ",expand:"\u6536\u8d77\u76f8\u4f3c\u5546\u54c1 "},debounce:{threshold:500,execAsap:true},manual:true});M.delegate(d,"click",".j_MoreSimilar",function(f){a(this,f);f.preventDefault()}.debounce(500,true),d);M.delegate(d,"click",".proThumb-img",function(g){var f=this,h=g.target;if(!!Y&&Y.toggle){if(Y!=f){a(f,g)}else{if(f.lastSku!==h){X(f)}}}}.debounce(500,true))});var S=function(c,d){return P.hasClass(c,d)||P.parent(c,"."+d)};M.on(Z.body,"click",function(d){var c=d.target;if(!S(c,"j_MoreSimilar")&&!S(c,"proThumb-img")&&!S(c,"j_SimilarRec")&&Y&&Y.toggle){a(Y,d)}});J();R&&P.append(P.create('<div style="clear:both;">'),W);var E=P.get(".j_MoreSimilar"),b=P.parent(E,".product");LIST.util.bindScrollAsync(E,function(){F({type:"image",id:"moreSimilar_01",imgSrc:"http://img03.taobaocdn.com/tps/i3/T1Ox.7XllhXXaIgN7P-230-159.png",closeArea:{coords:"80,117,149,140"},size:{x:230,y:159},anchor:{x:19,y:150},lazy:true,spotLight:false,onShow:function(){P.addClass(b,"product-hover");T&&(b.disableHoverOut=true)},onHide:function(){P.removeClass(b,"product-hover");T&&(b.disableHoverOut=false);M.detach(A,"resize",E._fgShowFn)}},function(d){function c(){d.showAt(E,{x:150,y:13})}c();M.on(A,"resize",E._fgShowFn=c.debounce(100,true))})},200,true)})}}});/*pub-1|2013-05-15 17:34:15*/KISSY.add(V+"/mods/smc",function(f){var a=f.DOM,e=f.UA.ie==6;var k="product",c="productIcons",b="productAttrs",h="product-iWrap";var i=/^https?:\/\/\S+$/i;var g=f.get("#J_ItemList");var d=(DEV_EV=="online"?"http://smc.tmall.com":"http://smc.tmall.net")+"/doGetNewSmcService.htm";function j(){if(!(this instanceof j)){return new j()}this._init()}f.augment(j,f.EventTarget,{_init:function(){if(!(g&&d)){return}this._request()},_request:function(){var l=this;f.ready(function(){var p=a.query("."+k,g),m=15,r=90,q=r/m,s=[],n=(document.getElementsByName("area_code")[0]||{value:""}).value,t=a.attr(g,"data-area");for(var o=0;o<q;o++){s.push(p.slice(o*m,(o+1)*m))}f.each(s,function(w,u){if(!(w[0]&&w[w.length-1])){return}var v=[w[0],w[w.length-1]];v&&LIST.util.bindScrollAsync(v,function(){var x=[],y;f.each(w,function(z){y=a.attr(z,"data-id");y&&(x[x.length]=y)});x.length&&f.io({dataType:"jsonp",url:d,data:{itemIds:x.join(","),areaId:n,t:e?+new Date:0},jsonp:"callback",jsonpCallback:"jsonp_smc_"+u,success:function(z){f.log(z);l._render(z,w,t)}})},0,true,1)})})},_render:function(m,l,n){if(!(m&&f.isObject(m))){return}f.each(l,function(u){var v=a.attr(u,"data-id");if(v&&m[v]){var t=m[v],r=t.icons,p=t.date;var o=f.get("."+c,u);if(!o){o=a.create('<p class="'+c+'"></p>');var s=a.get("."+b,u);if(s){a.insertBefore(o,s)}else{a.append(o,a.get("."+h,u))}}var q="";if(p&&p!=="0"){q+='<span class="productPostDay">\u9884\u8ba1<em>'+p+"</em>\u9001\u8fbe"+(n?"<b>"+n+"</b>":"")+"</span>"}q+=f.trim(a.html(o));r.length&&f.each(r,function(w){q+=i.test(w.imgsrc)?(i.test(w.link)?'<a href="'+w.link+'" title="'+w.alt+'" target="_blank"><img src="'+w.imgsrc+'" /></a>':'<img src="'+w.imgsrc+'" title="'+w.alt+'" />'):""});q&&a.html(o,q)}})}});return{init:function(){new j()}}});/*pub-1|2013-01-17 10:14:41*/KISSY.add(V+"/mods/error",function(B){var G=B.DOM,F=B.Event;var C=G.get("#J_LRTCancel"),H=G.get("#J_Nav"),A=G.get("#J_ComboRec");return{init:function(){C&&F.on(C,"click",function(D){D.preventDefault();G.show(H);G.hide(A)})}}});/*pub-1|2013-01-17 10:14:41*/KISSY.add(V+"/mods/target",function(B){var G=B.DOM,C=B.Event;var F=G.get("#J_Target"),A="http://delta.taobao.com/home/delivery/AllContentByPage.do?resourceIds=372&ip="+G.attr(F,"data-ip");return{init:function(){F&&B.getScript(A,function(){var D=__content_results||[];D.length&&B.each(D,function(E){G.html(F,E.content);LIST.util.exposureFn(E.exposureParam)})})}}});/*pub-1|2013-04-16 10:34:40*/KISSY.add(V+"/mods/minisite",function(f,b,h){var a=f.DOM,j=f.Event,c=f.Anim,g=f.UA.ie<=9,d=f.UA.ie==9,e=f.UA.ie==6;var i=f.get("#J_Minisite")||f.get("#J_MiniSite");return{init:function(){if(i){a.hasClass(i,"mv2")&&(function(){var v=this,q=v.anim,m=f.get(".j_MinisiteCon",i),p=f.get(".j_MinisitePrev",i),l=f.get(".j_MinisiteNext",i),o="minisite-disable",s=a.query(".j_MinisitePanel",i),r=s.length,u=0,t=5,k=function(){return a.innerWidth(i)},n=function(y,w,x){var z=function(){w=w||0;if(w==0){a.addClass(p,o)}else{a.removeClass(p,o)}if(w==r-1){a.addClass(l,o)}else{a.removeClass(l,o)}},A=function(){var C=k(),B=-(w||0)*C;a.css(m,{width:(r*C+t)+"px"});s.each(function(D){a.css(D,{width:C+"px"})});if(y){a.css(m,{left:B+"px"});z();return}if(q){q.stop()}v.anim=f.Anim(m,{left:B+"px"},2,"easeOutStrong",function(){z()});v.anim.run()};return !g||x?A():f.later(A,600)};if(r!==1){j.on(p,"click",function(w){w.halt();u!==0&&n(false,--u,true)});j.on(l,"click",function(w){w.halt();u!==r-1&&n(false,++u,true)})}else{a.hide([p,l])}n();LIST.msg.on("viewchange",function(w){n(false,u)});LIST.msg.fire("ie6Hover",{classname:"mv2"})})();a.hasClass(i,"mv3")&&(function(){function n(){var r=a.get(".j_MinisiteShopsInner",i),t=a.innerWidth(r)-(parseInt(a.css(r,"paddingLeft")||0)+parseInt(a.css(r,"paddingRight")||0)),s=a.query(".j_MinisiteShop",i),q=5;(s.length>1)&&a.css([a.get(".j_MinisitePrev",i),a.get(".j_MinisiteNext",i)],{visibility:"visible"});s.each(function(v){var u=0;f.each(v.children,function(w){if(w.tagName=="A"){u+=a.outerWidth(w.children[0],true)}else{if(w.tagName=="I"){u+=a.outerWidth(w,true)}}});a.css(a.get("ul",v),{width:t-u-q})})}n();f.use(V+"/widget/carousel",function(r,s){var q=new s(".minisite-shops",{effect:"scrollx",easing:"easeOutStrong",steps:1,circular:false,contentCls:"ks-switchable-content",prevBtnCls:"j_MinisitePrev",nextBtnCls:"j_MinisiteNext",disableBtnCls:"minisite-btn-disable"});LIST.msg.on("viewchange",function(t){q.resetLayout();n()})});var k=a.get(".j_MinisiteBanner",i),l=a.get("img",k),p=a.get(".j_MinisiteBrandsiteName",i),o=a.get(".j_MinisiteLogo",i);j.on([l,o],"mouseenter mouseleave",function(q){if(q.type=="mouseenter"){a.css(p,{textDecoration:"underline"})}else{a.css(p,{textDecoration:""})}});f.use(V+"/widget/favbrand",function(q,r){new r({container:i,numEl:q.get(".j_CollectBrandNum",i),cancelCls:"minisite-fav-collected"})});if(e){var m=function(q){if(!(q&&/.+\.png/.test(q.src))){return}a.css(q,{filter:'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+q.src+'",enabled="true", sizinMethod="scale");',position:"relative"});a.insert;q.src="http://a.tbcdn.cn/kissy/1.0.0/build/imglazyload/spaceball.gif"};var o=a.get("img",a.get(".j_MinisiteLogo",i));m(o);LIST.msg.fire("ie6Hover",{classname:"minisite-shops"})}})()}}}},{requires:["switchable","datalazyload"]});/*pub-1|2013-04-11 10:56:52*/KISSY.add(V+"/mods/accessorie",function(B){var G=B.DOM,C=B.Event;var F=G.get("#J_Accessories"),A=G.attr(F,"data-url");return{init:function(){F&&B.io.get(A,{t:+new Date},function(J){G.html(F,J);var I=G.get(".j_QTotal"),E=G.get(".j_QMore"),H=G.get(".product",F);if(I&&E){var L=G.html(I).match(/\d+/),L=L?L[0]:"",K=parseInt(L),D=function(){var O=Math.floor(G.innerWidth(F)/G.outerWidth(H)),N=Math.floor(G.innerHeight(F)/G.outerHeight(H)),M=O*N;K<=M&&G.hide(E)};D();LIST.msg.on("viewchange",function(M){D()})}})}}});/*pub-1|2013-01-17 10:14:41*/KISSY.add(V+"/city-codes",function(C){var B={"110000":["\u5317\u4eac"],"120000":["\u5929\u6d25"],"130000":["\u6cb3\u5317",{"130100":["\u77f3\u5bb6\u5e84"],"130200":["\u5510\u5c71"],"130300":["\u79e6\u7687\u5c9b"],"130400":["\u90af\u90f8"],"130500":["\u90a2\u53f0"],"130600":["\u4fdd\u5b9a"],"130700":["\u5f20\u5bb6\u53e3"],"130800":["\u627f\u5fb7"],"130900":["\u6ca7\u5dde"],"131000":["\u5eca\u574a"],"131100":["\u8861\u6c34"]}],"140000":["\u5c71\u897f",{"140100":["\u592a\u539f"],"140200":["\u5927\u540c"],"140300":["\u9633\u6cc9"],"140400":["\u957f\u6cbb"],"140500":["\u664b\u57ce"],"140600":["\u6714\u5dde"],"140700":["\u664b\u4e2d"],"140800":["\u8fd0\u57ce"],"140900":["\u5ffb\u5dde"],"141000":["\u4e34\u6c7e"],"141100":["\u5415\u6881"]}],"150000":["\u5185\u8499\u53e4",{"150100":["\u547c\u548c\u6d69\u7279"],"150200":["\u5305\u5934"],"150300":["\u4e4c\u6d77"],"150400":["\u8d64\u5cf0"],"150500":["\u901a\u8fbd"],"150600":["\u9102\u5c14\u591a\u65af"],"150700":["\u547c\u4f26\u8d1d\u5c14"],"150800":["\u5df4\u5f66\u6dd6\u5c14"],"150900":["\u4e4c\u5170\u5bdf\u5e03"],"152200":["\u5174\u5b89"],"152500":["\u9521\u6797\u90ed\u52d2"],"152900":["\u963f\u62c9\u5584"]}],"210000":["\u8fbd\u5b81",{"210100":["\u6c88\u9633"],"210200":["\u5927\u8fde"],"210300":["\u978d\u5c71"],"210400":["\u629a\u987a"],"210500":["\u672c\u6eaa"],"210600":["\u4e39\u4e1c"],"210700":["\u9526\u5dde"],"210800":["\u8425\u53e3"],"210900":["\u961c\u65b0"],"211000":["\u8fbd\u9633"],"211100":["\u76d8\u9526"],"211200":["\u94c1\u5cad"],"211300":["\u671d\u9633"],"211400":["\u846b\u82a6\u5c9b"]}],"220000":["\u5409\u6797",{"220100":["\u957f\u6625"],"220200":["\u5409\u6797"],"220300":["\u56db\u5e73"],"220400":["\u8fbd\u6e90"],"220500":["\u901a\u5316"],"220600":["\u767d\u5c71"],"220700":["\u677e\u539f"],"220800":["\u767d\u57ce"],"222400":["\u5ef6\u8fb9"]}],"230000":["\u9ed1\u9f99\u6c5f",{"230100":["\u54c8\u5c14\u6ee8"],"230200":["\u9f50\u9f50\u54c8\u5c14"],"230300":["\u9e21\u897f"],"230400":["\u9e64\u5c97"],"230500":["\u53cc\u9e2d\u5c71"],"230600":["\u5927\u5e86"],"230700":["\u4f0a\u6625"],"230800":["\u4f73\u6728\u65af"],"230900":["\u4e03\u53f0\u6cb3"],"231000":["\u7261\u4e39\u6c5f"],"231100":["\u9ed1\u6cb3"],"231200":["\u7ee5\u5316"],"232700":["\u5927\u5174\u5b89\u5cad"]}],"310000":["\u4e0a\u6d77"],"320000":["\u6c5f\u82cf",{"320100":["\u5357\u4eac"],"320200":["\u65e0\u9521"],"320300":["\u5f90\u5dde"],"320400":["\u5e38\u5dde"],"320500":["\u82cf\u5dde"],"320600":["\u5357\u901a"],"320700":["\u8fde\u4e91\u6e2f"],"320800":["\u6dee\u5b89"],"320900":["\u76d0\u57ce"],"321000":["\u626c\u5dde"],"321100":["\u9547\u6c5f"],"321200":["\u6cf0\u5dde"],"321300":["\u5bbf\u8fc1"]}],"330000":["\u6d59\u6c5f",{"330100":["\u676d\u5dde"],"330200":["\u5b81\u6ce2"],"330300":["\u6e29\u5dde"],"330400":["\u5609\u5174"],"330500":["\u6e56\u5dde"],"330600":["\u7ecd\u5174"],"330700":["\u91d1\u534e"],"330800":["\u8862\u5dde"],"330900":["\u821f\u5c71"],"331000":["\u53f0\u5dde"],"331100":["\u4e3d\u6c34"]}],"340000":["\u5b89\u5fbd",{"340100":["\u5408\u80a5"],"340200":["\u829c\u6e56"],"340300":["\u868c\u57e0"],"340400":["\u6dee\u5357"],"340500":["\u9a6c\u978d\u5c71"],"340600":["\u6dee\u5317"],"340700":["\u94dc\u9675"],"340800":["\u5b89\u5e86"],"341000":["\u9ec4\u5c71"],"341100":["\u6ec1\u5dde"],"341200":["\u961c\u9633"],"341300":["\u5bbf\u5dde"],"341500":["\u516d\u5b89"],"341600":["\u4eb3\u5dde"],"341700":["\u6c60\u5dde"],"341800":["\u5ba3\u57ce"]}],"350000":["\u798f\u5efa",{"350100":["\u798f\u5dde"],"350200":["\u53a6\u95e8"],"350300":["\u8386\u7530"],"350400":["\u4e09\u660e"],"350500":["\u6cc9\u5dde"],"350600":["\u6f33\u5dde"],"350700":["\u5357\u5e73"],"350800":["\u9f99\u5ca9"],"350900":["\u5b81\u5fb7"]}],"360000":["\u6c5f\u897f",{"360100":["\u5357\u660c"],"360200":["\u666f\u5fb7\u9547"],"360300":["\u840d\u4e61"],"360400":["\u4e5d\u6c5f"],"360500":["\u65b0\u4f59"],"360600":["\u9e70\u6f6d"],"360700":["\u8d63\u5dde"],"360800":["\u5409\u5b89"],"360900":["\u5b9c\u6625"],"361000":["\u629a\u5dde"],"361100":["\u4e0a\u9976"]}],"370000":["\u5c71\u4e1c",{"370100":["\u6d4e\u5357"],"370200":["\u9752\u5c9b"],"370300":["\u6dc4\u535a"],"370400":["\u67a3\u5e84"],"370500":["\u4e1c\u8425"],"370600":["\u70df\u53f0"],"370700":["\u6f4d\u574a"],"370800":["\u6d4e\u5b81"],"370900":["\u6cf0\u5b89"],"371000":["\u5a01\u6d77"],"371100":["\u65e5\u7167"],"371200":["\u83b1\u829c"],"371300":["\u4e34\u6c82"],"371400":["\u5fb7\u5dde"],"371500":["\u804a\u57ce"],"371600":["\u6ee8\u5dde"],"371700":["\u83cf\u6cfd"]}],"410000":["\u6cb3\u5357",{"410100":["\u90d1\u5dde"],"410200":["\u5f00\u5c01"],"410300":["\u6d1b\u9633"],"410400":["\u5e73\u9876\u5c71"],"410500":["\u5b89\u9633"],"410600":["\u9e64\u58c1"],"410700":["\u65b0\u4e61"],"410800":["\u7126\u4f5c"],"410900":["\u6fee\u9633"],"411000":["\u8bb8\u660c"],"411100":["\u6f2f\u6cb3"],"411200":["\u4e09\u95e8\u5ce1"],"411300":["\u5357\u9633"],"411400":["\u5546\u4e18"],"411500":["\u4fe1\u9633"],"411600":["\u5468\u53e3"],"411700":["\u9a7b\u9a6c\u5e97"]}],"420000":["\u6e56\u5317",{"420100":["\u6b66\u6c49"],"420200":["\u9ec4\u77f3"],"420300":["\u5341\u5830"],"420500":["\u5b9c\u660c"],"420600":["\u8944\u6a0a"],"420700":["\u9102\u5dde"],"420800":["\u8346\u95e8"],"420900":["\u5b5d\u611f"],"421000":["\u8346\u5dde"],"421100":["\u9ec4\u5188"],"421200":["\u54b8\u5b81"],"421300":["\u968f\u5dde"],"422800":["\u6069\u65bd"]}],"430000":["\u6e56\u5357",{"430100":["\u957f\u6c99"],"430200":["\u682a\u6d32"],"430300":["\u6e58\u6f6d"],"430400":["\u8861\u9633"],"430500":["\u90b5\u9633"],"430600":["\u5cb3\u9633"],"430700":["\u5e38\u5fb7"],"430800":["\u5f20\u5bb6\u754c"],"430900":["\u76ca\u9633"],"431000":["\u90f4\u5dde"],"431100":["\u6c38\u5dde"],"431200":["\u6000\u5316"],"431300":["\u5a04\u5e95"],"433100":["\u6e58\u897f"]}],"440000":["\u5e7f\u4e1c",{"440100":["\u5e7f\u5dde"],"440200":["\u97f6\u5173"],"440300":["\u6df1\u5733"],"440400":["\u73e0\u6d77"],"440500":["\u6c55\u5934"],"440600":["\u4f5b\u5c71"],"440700":["\u6c5f\u95e8"],"440800":["\u6e5b\u6c5f"],"440900":["\u8302\u540d"],"441200":["\u8087\u5e86"],"441300":["\u60e0\u5dde"],"441400":["\u6885\u5dde"],"441500":["\u6c55\u5c3e"],"441600":["\u6cb3\u6e90"],"441700":["\u9633\u6c5f"],"441800":["\u6e05\u8fdc"],"441900":["\u4e1c\u839e"],"442000":["\u4e2d\u5c71"],"445100":["\u6f6e\u5dde"],"445200":["\u63ed\u9633"],"445300":["\u4e91\u6d6e"]}],"450000":["\u5e7f\u897f",{"450100":["\u5357\u5b81"],"450200":["\u67f3\u5dde"],"450300":["\u6842\u6797"],"450400":["\u68a7\u5dde"],"450500":["\u5317\u6d77"],"450600":["\u9632\u57ce\u6e2f"],"450700":["\u94a6\u5dde"],"450800":["\u8d35\u6e2f"],"450900":["\u7389\u6797"],"451000":["\u767e\u8272"],"451100":["\u8d3a\u5dde"],"451200":["\u6cb3\u6c60"],"451300":["\u6765\u5bbe"],"451400":["\u5d07\u5de6"]}],"460000":["\u6d77\u5357",{"460100":["\u6d77\u53e3"],"460200":["\u4e09\u4e9a"]}],"500000":["\u91cd\u5e86"],"510000":["\u56db\u5ddd",{"510100":["\u6210\u90fd"],"510300":["\u81ea\u8d21"],"510400":["\u6500\u679d\u82b1"],"510500":["\u6cf8\u5dde"],"510600":["\u5fb7\u9633"],"510700":["\u7ef5\u9633"],"510800":["\u5e7f\u5143"],"510900":["\u9042\u5b81"],"511000":["\u5185\u6c5f"],"511100":["\u4e50\u5c71"],"511300":["\u5357\u5145"],"511400":["\u7709\u5c71"],"511500":["\u5b9c\u5bbe"],"511600":["\u5e7f\u5b89"],"511700":["\u8fbe\u5dde"],"511800":["\u96c5\u5b89"],"511900":["\u5df4\u4e2d"],"512000":["\u8d44\u9633"],"513200":["\u963f\u575d"],"513300":["\u7518\u5b5c"],"513400":["\u51c9\u5c71"]}],"520000":["\u8d35\u5dde",{"520100":["\u8d35\u9633"],"520200":["\u516d\u76d8\u6c34"],"520300":["\u9075\u4e49"],"520400":["\u5b89\u987a"],"522200":["\u94dc\u4ec1"],"522300":["\u9ed4\u897f\u5357"],"522400":["\u6bd5\u8282"],"522600":["\u9ed4\u4e1c\u5357"],"522700":["\u9ed4\u5357"]}],"530000":["\u4e91\u5357",{"530100":["\u6606\u660e"],"530300":["\u66f2\u9756"],"530400":["\u7389\u6eaa"],"530500":["\u4fdd\u5c71"],"530600":["\u662d\u901a"],"530700":["\u4e3d\u6c5f"],"530800":["\u666e\u6d31"],"530900":["\u4e34\u6ca7"],"532300":["\u695a\u96c4"],"532500":["\u7ea2\u6cb3"],"532600":["\u6587\u5c71"],"532800":["\u897f\u53cc\u7248\u7eb3"],"532900":["\u5927\u7406"],"533100":["\u5fb7\u5b8f"],"533300":["\u6012\u6c5f"],"533400":["\u8fea\u5e86"]}],"540000":["\u897f\u85cf",{"540100":["\u62c9\u8428"],"542100":["\u660c\u90fd"],"542200":["\u5c71\u5357"],"542300":["\u65e5\u5580\u5219"],"542400":["\u90a3\u66f2"],"542500":["\u963f\u91cc"],"542600":["\u6797\u829d"]}],"610000":["\u9655\u897f",{"610100":["\u897f\u5b89"],"610200":["\u94dc\u5ddd"],"610300":["\u5b9d\u9e21"],"610400":["\u54b8\u9633"],"610500":["\u6e2d\u5357"],"610600":["\u5ef6\u5b89"],"610700":["\u6c49\u4e2d"],"610800":["\u6986\u6797"],"610900":["\u5b89\u5eb7"],"611000":["\u5546\u6d1b"]}],"620000":["\u7518\u8083",{"620100":["\u5170\u5dde"],"620200":["\u5609\u5cea\u5173"],"620300":["\u91d1\u660c"],"620400":["\u767d\u94f6"],"620500":["\u5929\u6c34"],"620600":["\u6b66\u5a01"],"620700":["\u5f20\u6396"],"620800":["\u5e73\u51c9"],"620900":["\u9152\u6cc9"],"621000":["\u5e86\u9633"],"621100":["\u5b9a\u897f"],"621200":["\u9647\u5357"],"622900":["\u4e34\u590f"],"623000":["\u7518\u5357"]}],"630000":["\u9752\u6d77",{"630100":["\u897f\u5b81"],"632100":["\u6d77\u4e1c"],"632200":["\u6d77\u5317"],"632300":["\u9ec4\u5357"],"632500":["\u6d77\u5357"],"632600":["\u679c\u6d1b"],"632700":["\u7389\u6811"],"632800":["\u6d77\u897f"]}],"640000":["\u5b81\u590f",{"640100":["\u94f6\u5ddd"],"640200":["\u77f3\u5634\u5c71"],"640300":["\u5434\u5fe0"],"640400":["\u56fa\u539f"],"640500":["\u4e2d\u536b"]}],"650000":["\u65b0\u7586",{"650100":["\u4e4c\u9c81\u6728\u9f50"],"650200":["\u514b\u62c9\u739b\u4f9d"],"652100":["\u5410\u9c81\u756a"],"652200":["\u54c8\u5bc6"],"652300":["\u660c\u5409"],"652700":["\u535a\u5c14\u5854\u62c9"],"652800":["\u5df4\u97f3\u90ed\u695e"],"652900":["\u963f\u514b\u82cf"],"653000":["\u514b\u5b5c\u52d2\u82cf"],"653100":["\u5580\u4ec0"],"653200":["\u548c\u7530"],"654000":["\u4f0a\u7281"],"654200":["\u5854\u57ce"],"654300":["\u963f\u52d2\u6cf0"]}],"710000":["\u53f0\u6e7e",{"710200":["\u9ad8\u96c4"],"710300":["\u53f0\u5357"],"710500":["\u91d1\u95e8"],"710600":["\u5357\u6295"],"710700":["\u57fa\u9686"],"710900":["\u5609\u4e49"],"711100":["\u53f0\u5317"],"711200":["\u5b9c\u5170"],"711300":["\u65b0\u7af9"],"711400":["\u6843\u56ed"],"711500":["\u82d7\u6817"],"710400":["\u53f0\u4e2d"],"711700":["\u5f70\u5316"],"712100":["\u4e91\u6797"],"712400":["\u5c4f\u4e1c"],"712500":["\u53f0\u4e1c"],"712600":["\u82b1\u83b2"],"712700":["\u6f8e\u6e56"]}],"810000":["\u9999\u6e2f",{"810100":["\u9999\u6e2f\u5c9b"],"810200":["\u4e5d\u9f99"],"810300":["\u65b0\u754c"]}],"820000":["\u6fb3\u95e8",{"820100":["\u6fb3\u95e8\u534a\u5c9b"]}]};function A(){if(!(this instanceof A)){return new A()}return C.clone(B)}return A});/*pub-1|2013-05-17 16:24:34*/KISSY.add(V+"/mods/album",function(e,a,l,d,i){var j,k,g,b=-1,h=3,f,c;return{switchView:function(p){if(p===undefined){p=j?0:1}if(p==j){return}e.each(a.query(".cover",k),function(s){a.get("img",s).style.left=""});e.each(a.query(".count",k),function(s){s.style.right=""});e.each(a.query(".prod",k),function(s){s.style.right=""});j=p;if(j){if(e.UA.ie){a.css(k,{display:"none"})}else{a.css(k,{overflow:"hidden",height:a.height(k)+"px"})}a.css(a.get("ul",k),{height:"auto",position:"static"});this.render(3);a.addClass(k,"open");a.addClass(a.get("i",a.get("#J_AlbumOpen",k)),"ui-more-expand-l-arrow");a.text(a.get("span",a.get("#J_AlbumOpen",k)),"\u6536\u8d77");function o(){a.css(k,{height:"auto",overflow:"inherit",display:"block"})}if(e.UA.ie){o();return}if(c){c.stop()}c=new i(k,{height:k.scrollHeight+"px"},1.5,"easeBoth",o);c.run()}else{var r=g.list.slice(0,(b+1)*h);window.atpanelFun(","+r[r.length-1].subjectId+",,,subject-close,7,subject-close,");if(c){c.stop()}var q=225,m=a.height(k);function n(){a.css(a.get("ul",k),{height:"200px",overflow:"hidden",position:"relative"});a.removeClass(k,"open");a.removeClass(a.get("i",a.get("#J_AlbumOpen",k)),"ui-more-expand-l-arrow");a.text(a.get("span",a.get("#J_AlbumOpen",k)),"\u5c55\u5f00");a.css(k,{height:"auto",overflow:"inherit",marginTop:"0px"});a.scrollTop(a.scrollTop()-(m-q))}if(e.UA.ie){n();return}c=new i(k,{height:q+"px",marginTop:(m-q)+"px"},0.5,"easeBoth",n);c.run()}},renderMore:function(){this.render(b+4)},render:function(t,r){var m=this;if(t<=b){return}if(!f&&g.list.length<(t+1)*h&&g.count>g.list.length){f=true;e.use("ajax",function(w,u){var x=[];w.each(g.list,function(y){x.push(y.subjectId)});var v=a.attr(k,"data-url");u.jsonp(v,{ids:x.join(",")},function(y){g.list=g.list.concat(y.list);g.count=g.list.length;m.render(t,r)})});return}var n='{{#each data as item index}}				<li class="album{{#if (!fixed)}} autoHide{{/if}} grid{{((start+index)%4)}}">					<div class="mask"></div>					<div class="cover"><a href="{{item.subjectUrl}}" target="_blank" atpanel="{{start+index}}-{{cellNum}},{{item.subjectId}},,,subject-thd,7,subject-thd,"><img src="{{item.coverPicUr}}"></a></div>					<div class="prod"><a href="{{item.subjectUrl}}" target="_blank" atpanel="{{start+index}}-{{cellNum}},{{item.subjectId}},,,subject-thd,7,subject-thd,"><img src="{{item.productPicUrl}}"></a></div>					<div class="title"><i></i><a href="{{item.subjectUrl}}" target="_blank" atpanel="{{start+index}}-{{cellNum}},{{item.subjectId}},,,subject-thd,7,subject-thd,">{{item.subjectTitle}}</a></div>					<div class="brand"><img src="{{#if item.brandPicUrl!=="" && new RegExp("[.]((jpg)|(jpeg)|(gif)|(png))([?].*)*$","i").test(item.brandPicUrl)}}{{item.brandPicUrl}}{{#else}}http://img02.taobaocdn.com/tps/i2/T1tJg_XnNdXXc6Yc2r-1-1.gif{{/if}}"></div>					<div class="count">{{item.itemCount}}</div>				</li>			    {{/each}}';if(b>=0){a.css(k,{overflow:"hidden",height:a.height(k)+"px"})}var s=g.list.slice((b+1)*h,(t+1)*h),p=[];a.append(a.create(d(n).render({data:g.list.slice((b+1)*h,(t+1)*h),start:(b+1)*h,cellNum:h,fixed:r})),a.get("ul",k));if(b>=0){if(c){c.stop()}c=new i(k,{height:k.scrollHeight+"px"},2,"easeBoth",function(){a.css(k,{height:"auto",overflow:"inherit"})});c.run()}b=t;e.each(s,function(u){p.push(u.subjectId)});var o=r?"subject-fst":"subject-more";window.atpanelFun(","+p.join("-")+",,,"+o+",7,"+o+",,");try{new Image().src="http://ac.atpanel.com/tmalllist.1.2?id="+p.join(",")}catch(q){}if((t+1)*h>=g.count){a.css(a.get("#J_AlbumMore",k),{display:"none"})}},init:function(){k=a.get("#J_AlbumPanel");if(a.width(a.parent(k))>=1390){h=4}g=window._albumData;var p={queue:false,duration:0.5,easing:"easeNone"};var m=a.hasClass(k,"albumPanelA"),q=a.hasClass(k,"albumPanelB");l.delegate(document,"mouseenter mouseleave",".album",function(v){var w=v.currentTarget,y=a.parent(w,".albumPanel"),z=!!y,r=a.hasClass(y,"open"),x=a.get(".cover",w),t=a.get("img",x),s=a.get(".count",w),u=a.get(".prod",w);if(v.type==="mouseenter"){(z?!q:true)&&new i(t,{left:-80,top:-40,width:400,height:400},p).run();new i(s,{right:(z?(r&&!m):true)?80:48},p).run();new i(u,{right:0},p).run()}else{new i(t,{left:(z?(r&&!q&&!m):true)?-40:0,top:0,width:320,height:320},p).run();if(!z||(!m&&!q&&r)){return}new i(s,{right:-18},p).run();new i(u,{right:q?-80:-48},p).run()}});if(!k||!g||!g.list||!g.list.length){return}var n=this,o='<div class="spliter1"></div><ul class="clearfix"></ul>				    {{#if data.count>cellNum}}					<a class="more" id="J_AlbumMore">\u52a0\u8f7d\u66f4\u591a\u4e13\u8f91</a>				    {{/if}}				    <div class="spliter"></div>				    {{#if data.count>cellNum}}					<div class="open" id="J_AlbumOpen"><span>\u5c55\u5f00</span><i class="ui-more-drop-l-arrow"></i><s></s></div>				    {{/if}}';a.html(k,d(o).render({data:g,cellNum:h}));n.render(0,true);a.removeClass(k,"hidden");j=0;l.on("#J_AlbumOpen","click",function(){n.switchView()});l.on("#J_AlbumMore","click",function(){n.renderMore()})}}},{requires:["dom","event","template","anim"]});/*pub-1|2013-04-18 15:25:23*/KISSY.add(V+"/list",function(b,t,c,f){var n=b.DOM,m=b.Event,a=window,e=b.get(".j_MinisiteDrop")||b.get("#J_MiniSiteDrop"),o=b.get("#J_ItemList"),p=b.query(".productImg",o),j=n.hasClass(o,"miniView"),h=!!n.hasAttr(b.get(".main"),"data-notSwitch"),g=b.get("#J_BtmSearch"),k="btmSearch-loading",s=false,l=a.g_config.view;if(j&&!h){var u=function(){var v="_160x160",i="_b";o.className=o.className.replace(/miniView/g,"view");b.each(p,function(x){var w=b.get("img",x),y=n.attr(w,"data-ks-lazyload");b.log(w.src);w.src?w.src=w.src.replace(v,i):n.attr(w,"data-ks-lazyload",y.replace(v,i))});s=true};l>0&&u();LIST.msg.on("viewchange",function(i){!s&&i.view>0&&u()})}f.setCfg({expand:true});for(var q=0,r=arguments.length;q<r;q++){var d=arguments[q];if(d&&d.init){d.init()}}t(o,{mod:"manual",diff:500});LIST.msg.fire("ie6Hover",{classname:["product","productImg-wrap"]});new c().init();b.ready(function(v){!!e&&LIST.msg.fire("expand",{el:e,classname:"minisite"});if(g){var i=t(g,{mod:"manual",execScript:false});i.addCallback(g,function(){n.removeClass(g,k);v.use(V+"/mods/btm-search",function(x,w){w&&w.init()})})}})},{requires:["datalazyload","./mods/p4p","./mods/dsr","./mods/ald","./mods/crumb","./mods/attr","./mods/album","./mods/filter","./mods/item-sku","./mods/product","./mods/list-view","./mods/ald03046","./mods/smc","./mods/error","./mods/target","./mods/minisite","./mods/accessorie"]});