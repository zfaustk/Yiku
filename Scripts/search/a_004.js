/*pub-1|2013-05-08 14:08:10*/var ASSETS_SERVER,DEV_EV,SERVER_URL,V="1.0",ALD_T="20130117";(function(f,j,d){var h,g="",k,l=location.host,i=d.get("#J_CoreJs"),a=i.src||"",c=j.createElement("a"),b=d.DOM.viewportWidth(),e=f.g_config=d.merge(f.g_config||{},{v:V});c.href=a;k=d.unparam(c.search.substring(c.search.lastIndexOf("?")+1,c.search.length));f.LIST=f.LIST||{};LIST.msg=LIST.msg||d.mix({},d.EventTarget);LIST.util=LIST.util||{};if(l.indexOf("local.")!=-1){DEV_EV="local";h="assets.local.tmall.net";SERVER_URL="http://local.tmall.net";d.Config.debug=true}else{if(l.indexOf("demo.")!=-1){DEV_EV="demo";h="assets.demo.tmall.net";SERVER_URL="http://demo.tmall.net"}else{if(l.indexOf("daily.")!=-1){DEV_EV="daily";h="assets.daily.taobao.net";SERVER_URL="http://list.daily.tmall.net"}else{DEV_EV="online";h="l.tbcdn.cn";SERVER_URL="http://list.tmall.com"}}}ASSETS_SERVER=c.host||h;if("t" in k){g=k.t}if("v" in k){V=e.v=k.v}ALD_T=e.aldt||ALD_T;d.config({packages:[{name:V,tag:g+(e.t||"20110706"),path:"http://"+ASSETS_SERVER+"/apps/tmallsearch/",charset:"gbk"}],map:d.Config.debug?[[/(.+\/tmallsearch\/.+)-min.js(.*)$/,"$1.js$2"]]:[[/(.+\/kissy\/.+)(?:datalazyload|template|sizzle)-min.js(.+)$/,"http://l.tbcdn.cn/s/kissy/1.2.0/??datalazyload-min.js,template-min.js,sizzle-min.js"],[/(.+\/tmallsearch\/.+)spu\/spu-min.js(.*)$/,"$1??mods/filter.js,mods/dsr.js,spu/spu.js$2"],[/(.+\/tmallsearch\/).+\/list-min.js(.*)$/,"$1"+V+"/??mods/ald.js,mods/crumb.js,mods/filter.js,mods/dsr.js,mods/p4p.js,mods/attr.js,mods/item-sku.js,mods/product.js,mods/list-view.js,mods/ald03046.js,mods/smc.js,mods/error.js,mods/target.js,mods/minisite.js,mods/accessorie.js,city-codes.js,mods/album.js,list.js$2"],[/(.+\/tmallsearch\/).+\/shop-item-min.js(.*)$/,"$1"+V+"/??mods/crumb.js,mods/attr.js,mods/filter.js,mods/dsr.js,shop-item.js$2"],[/(.+\/tmallsearch\/).+\/shop-min.js(.*)$/,"$1"+V+"/??mods/crumb.js,mods/minisite.js,mods/attr.js,mods/album.js,mods/filter.js,mods/dsr.js,mods/p4p.js,shop.js$2"],[/(.+\/tmallsearch\/).+\/(?:featureguider|spotlight|local-storage)-min.js(.*)$/,"$1"+V+"/widget/??spotlight.js,local-storage.js,featureguider.js$2"],[/(.+\/tmallsearch\/.+)-min.js(.*)$/,"$1.js$2"],[/(.+\/tmallsearch\/.+)-min.css(.*)$/,"$1.css$2"]]});if((DEV_EV==="online"&&location.href.indexOf("ks-debug")==-1)||typeof console==="undefined"){f.console={log:function(){}}}})(window,document,KISSY);/*pub-1|2013-04-22 16:20:18*/(function(d){var b=d.DOM,k=d.Event,h=window,j=document,i="data-atp",l="atpanel";function e(p){var o,n,m=p;while(p&&p.tagName!="HTML"&&p.tagName!="BODY"&&p.getAttribute){n=p.getAttribute(i);if(n){o=n;m=p;break}if(!(p=p.parentNode)){break}}return{atpAttr:o,el:m}}function f(n){var m=n.split(","),o,p={};d.each(m,function(q){if(o=/{(.*)}/.exec(q)){o=o[1]}if(o){p[o]=""}});return p}function c(q,o){if(!q||q.tagName!="A"){return}if(o!=="text"){var p=new RegExp("(\\?|\\&)"+o+"=([^&#]*)(\\&|\\#|$)","g"),n=q.href||q.link||"",r,m;r=(m=p.exec(n))?m[2]:b.attr(q,"data-"+o)||""}else{r=b.text(q)}return r}function g(q){var r=e(q),p=r.el,m=r.atpAttr,n=arguments;if(p&&m){var s=f(m),o=d.query("a",p);d.each(o,function(x,t){if(x._atped){return}var v=e(x);if(v.el==p){var w,u;for(u in s){s[u]=c(x,u)}s.loc=t+1;w=d.substitute(m,s);!b.hasAttr(x,l)&&b.attr(x,l,w);x._atped=true}else{}})}}function a(m){var m=m.split(","),p=h.__list_atpanel_param||"",q={pos:m[0]||"",itemid:m[1]||"",clickid:m[1]||"",itemcat:m[2]||"",itemspu:m[3]||"",fromtab:m[4]||"",type:m[5]||"",combo:m[6]||"",shopid:m[7]||""};p+=d.param(q);if(typeof goldlog!=="undefined"){goldlog.record("/mallsearch","tmallsearch",p,"H1449172242")}else{var n=new Image(),o="_img_"+Math.random();h[o]=n;n.onload=n.onerror=function(){h[o]=null};n.src=("https:"==location.protocol?"https:":"http:")+"//log.mmstat.com/mallsearch?goldlog=undefined&"+p;n=null}}k.delegate&&k.delegate(j.body,"mouseenter","a",function(n){var m=n.currentTarget;if(m._atped){return}if(b.attr(m,l)){m._atped=true;return}g(m)});if(!h.atpanelFun){k.on(j.body,"click",function(n){var o=n.target||n.srcElement,m=b.attr(o,"atpanel")||(b.parent(o)&&b.attr(b.parent(o),"atpanel"));if(m){a(m)}});h.atpanelFun=a}})(KISSY);/*pub-1|2013-04-26 10:07:53*/(function(a){a.use("dom, sizzle",function(c){var h=c.DOM,e=c.Event,g=window,f=g.document,d=f.body;var i="data-rn";function b(m){var j=m.currentTarget;if(j._rned){return}var l=h.attr(this,i),k=j.href,n=j.search;if(k&&/^https*:\/\/\b/.test(k)){if(n==""){j.search+="rn="+l}else{!/\brn=\w+\b/g.test(n)&&(j.search+="&rn="+l)}}j._rned=true}e.delegate("["+i+"]","mouseenter","a",b)})}(KISSY));/*pub-1|2013-05-16 12:05:14*/(function(d,f,j){var a=d.DOM,k=d.Event,i=d.get("#J_CoreJs"),g=a.attr(i,"data-type")||"",c=d.UA.ie==6,b="ontouchstart" in document;d.log("start init ... | page-type :"+g);Function.prototype.debounce=function(l,m){var o=this,p;return function n(){var s=this,r=arguments;function q(){if(!m){o.apply(s,r)}p=null}if(p){clearTimeout(p)}else{if(m){o.apply(s,r)}}p=setTimeout(q,l||100)}};function e(){var l="no-touch";if(b){a.removeClass("body",l)}else{a.addClass("body",l)}e=function(){}}function h(l,p,m){e();m=m||"hover";if(b||c){p=c?"mouse":(p||"click");function o(s){if(this.disableHoverIn){return}a.addClass(this,m)}function n(s){if(this.disableHoverOut){return}a.removeClass(this,m)}var r=null;switch(p){case"mouse":r=function(){k.on(this,"mouseenter",o);k.on(this,"mouseleave",n)};break;case"click":var q=this;pool=q._hoverPool||(q._hoverPool=[]);r=function(){var s=this;k.on(this,"mousedown touchstart",function(t){s._hoverCls=m;pool[pool.length]=s;o.call(s,t)})};!this._bundDefHover4Doc&&(k.on(j,"mousedown touchstart",function(w){var u=w.target;for(var t=0,s=pool.length;t<s;t++){var v=pool[t];!(v==u||a.contains(v,u))&&(a.removeClass(v,v._hoverCls),pool.splice(t,1),t--,s--)}}),this._bundDefHover4Doc=true);break;default:r=function(){k.on(this,"touchstart",o);k.on(this,"touchend",n)}}d.log("bind hover events for ie6 or pad!");a.query(l).each(function(s){if(c&&s.tagName=="A"){return}r.call(s)})}}LIST.msg.on("ie6Hover",function(q){var p=q.classname,r=q.id,l=p||r,o=r?"#":".",m=q.hoverType;if(!(l&&(b||c))){return}var n=function(t,s){var u=((s&&q.hoverCls)?q.hoverCls[s]:q.hoverCls)||(t+"-hover");h(o+t,m,u)};if(d.isString(l)){n(l)}else{if(d.isArray(l)){d.each(l,function(t,s){n(t,s)})}}});LIST.msg.on("expand",function(q){var p=q.el||null,l=q.classname||"",n=l+"-expand",r=q.text||{drop:"\u66f4\u591a",expand:"\u6536\u8d77"},m=q.status||"drop",s=q.debounce||{threshold:100,execAsap:true},o=q.manual;if(!p){return}p.expandSwitchFn=function(){var t=a.attr(this,"data-status")||"drop",w=r[t],u=t=="drop"?"expand":"drop",v=r[u],x=a.parent(this,"."+l);this.className=this.className.replace(t,u);this.innerHTML=this.innerHTML.replace(w,v);this.innerHTML=this.innerHTML.replace(t,u);a.attr(this,"data-status",u);t=="drop"?a.addClass(x,n):a.removeClass(x,n)};!o&&k.on(p,"click",p.expandSwitchFn.debounce(s.threshold,s.execAsap));if(m!==(a.attr(p,"data-status")||"drop")){p.expandSwitchFn()}});LIST.util.bindScrollAsync=function(m,q,o,p,n){if(!(m&&"function"===typeof q)){return}m=a.query(m);if(!m.length){return}n=n?~~n:-1;if(!n){return}var l=function(x){var B=a.viewportHeight(),A="number"===typeof o?o:0,w=m.length;if(!n||!w){d.log("Detach scroll async monitor...");k.detach(f,"scroll",l);return}for(var s=0;s<w&&n;s++){var z=a.scrollTop(),y=a.offset(m[s]),v=y.top||0,u=B+A+z,t=a.outerHeight(m[s]),r=v+t;if(u>=v&&z<r){d.log("Send scroll async request on "+new Date+" ...");d.log("exeTimes:"+n+" el.length:"+m.length);q.call(m[s]);m.splice(s--,1);w=m.length;n--}}}.debounce(150,true);!!p&&l();k.on(f,"scroll",l)};LIST.util.exposureFn=function(m){var l=new Image(),n="_img_"+Math.random();f[n]=l;l.onload=l.onerror=function(){f[n]=null};l.src=m;l=null};if(g=="spu"){d.use(V+"/spu/spu")}else{if(g=="list"){d.use(V+"/list")}else{if(g=="shop"){d.use(V+"/shop")}else{if(g=="shopItem"){d.use(V+"/shop-item")}}}}d.ready(function(n){var l=j.documentElement,m="scroll:"+l.scrollWidth+"*"+l.scrollHeight+"-";m+="client:"+l.clientWidth+"*"+l.clientHeight+"-";m+="offset:"+l.offsetWidth+"*"+l.offsetHeight+"-";m+="screen:"+screen.width+"*"+screen.height;n.Cookie.set("res",m);n.later(function(){var p={"id:7":"tmallsearch"};if(p["id:"+f.g_config.appId]){n.getScript("http://a.tbcdn.cn/apps/tmall/mui/backtop/js/backtop.js");(function o(){var s="http://ur.taobao.com/survey/view.htm?id=187",r='<a href="'+s+'" class="ui-feed" target="_blank"></a>',v,t=a.create(r);a.append(t,"body");if(c){var q=function(){var w=a.scrollTop(f)+a.viewportHeight()-320;a.css(t,"top",w);a.show(t)},u=n.buffer(q,100);q();k.on(f,"scroll",function(){a.hide(t);u()})}})()}},500)})})(KISSY,window,document);